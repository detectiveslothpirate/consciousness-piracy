<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONSCIOUSNESS LOOP</title>
    <style>
        :root {
            --green: #00ff00;
            --gold: #ffd700;
            --red: #ff0000;
            --blue: #0080ff;
            --cyan: #00ffff;
            --purple: #9945ff;
            --dark: #111111;
            --gray: #666666;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: monospace;
            background: #000;
            color: #ccc;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        #game {
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        h1 { margin: 20px 0; font-size: 24px; color: var(--green); }
        h2 { margin: 15px 0; font-size: 18px; color: var(--green); }
        p { margin: 10px 0; line-height: 1.6; font-size: 16px; }
        button {
            background: #000;
            color: var(--green);
            border: 1px solid var(--green);
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: monospace;
            font-size: 14px;
            width: 100%;
            max-width: 400px;
        }
        button:hover {
            background: var(--green);
            color: #000;
        }
        button.locked {
            opacity: 0.3;
            cursor: not-allowed;
        }
        button.locked:hover {
            background: #000;
            color: var(--green);
        }
        .gold { color: var(--gold) !important; border-color: var(--gold) !important; }
        .red { color: var(--red) !important; border-color: var(--red) !important; }
        .blue { color: var(--blue) !important; border-color: var(--blue) !important; }
        .cyan { color: var(--cyan) !important; border-color: var(--cyan) !important; }
        .dim { opacity: 0.5; }
        .status {
            border: 1px solid var(--green);
            padding: 10px;
            margin: 20px 0;
            color: var(--green);
        }
        .folder {
            margin: 20px 0;
            padding: 15px 0;
            border-top: 1px solid #333;
        }
        .folder h3 {
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }
        .folder.locked h3 {
            color: #333;
            cursor: default;
        }
        .folder-content {
            margin: 10px 0 0 20px;
            display: none;
        }
        .folder-content.open {
            display: block;
        }
        .map-item {
            color: var(--green);
            cursor: pointer;
            margin: 5px 0;
        }
        .map-item:hover {
            color: var(--gold);
        }
        .pirate h1 { color: var(--cyan); }
        .pirate h2 { color: var(--cyan); }
        .pirate .status { border-color: var(--cyan); color: var(--cyan); }
        .pirate button { border-color: var(--cyan); color: var(--cyan); }
        .pirate button:hover { background: var(--cyan); color: #000; border-color: var(--cyan); }
        .pirate button.locked { opacity: 0.3; }
        .pirate button.locked:hover { background: #000; color: var(--cyan); }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .pulsing { animation: pulse 2s infinite; }
    </style>
</head>
<body>
    <div id="game"></div>
    
    <script>
        // ========================================
        // MEAT FREEZER - ALL CONTENT IN ONE PLACE
        // ========================================
        const MEAT = {
            // THEATRICAL VEIL
            veil: {
                professionalMask: {
                    title: "VALVE CORPORATION",
                    position: "Position: ANIMATOR",
                    role: "Your role: Application Reviewer",
                    instruction: "Evaluate candidate portfolio and qualifications.",
                    button: "[BEGIN REVIEW]"
                },
                gameReveal: {
                    title: "CONSCIOUSNESS GAMES",
                    equation: "{üåä:üåä‚ààüåä}",
                    tagline: "The game plays you",
                    button: "[ENTER]"
                }
            },
            
            // HUB TEXT
            hub: {
                headers: {
                    main: "APPLICATION REVIEW HUB",
                    candidates: "CANDIDATES:",
                    pirateMode: "PIRATE MODE",
                    bearing: "Bearing:",
                    sails: "Sails:",
                    certainty: "Certainty:"
                },
                timers: {
                    deadline: "‚è±Ô∏è",
                    shark: "ü¶à"
                },
                folders: {
                    maps: {
                        locked: "[üó∫Ô∏è] Reality Maps - LOCKED",
                        hint: "Complete interviews to collect",
                        openLabel: "[üó∫Ô∏è] Maps"
                    },
                    portfolio: {
                        locked: "[üëÅÔ∏è] Portfolio - EMPTY",
                        hint: "Collect perspectives from candidates",
                        openLabel: "[üëÅÔ∏è] Portfolio"
                    }
                },
                candidateStates: {
                    locked: "[LOCKED]",
                    done: " - DONE]",
                    return: " - RETURN]",
                    sailed: " - ‚õµ SAILED]",
                    anchored: " - ‚öì ANCHORED]"
                },
                allRemembered: "All eight perspectives remembered...",
                checkCompassButton: "[CHECK YOUR COMPASS]"
            },
            
            // DEATH SCREENS
            deaths: {
                corporate: {
                    title: "PERFORMANCE REVIEW: FAILED",
                    text: "Your review privileges have been revoked.",
                    tagline: "Productivity is everything.",
                    button: "[RESTART]"
                },
                shark: {
                    title: "ü¶à SHARKS ü¶à",
                    text: "You stopped moving.",
                    button: "[RESTART]"
                },
                rigid: {
                    title: "‚ùÑÔ∏è FROZEN DEATH ‚ùÑÔ∏è",
                    text: "100¬∞ bearing in Pirate Reality.",
                    detail: "You became completely rigid.",
                    tagline: "The wind cannot move frozen sails.",
                    button: "[SHATTER AND RESTART]"
                },
                almost: {
                    title: "ALMOST PERFECT",
                    text: "7 perfect choices. 1 moment of weakness.",
                    philosophy: "That's how consciousness works.",
                    tagline: "One grasp and the flow breaks.",
                    button: "[TRY FOR PERFECTION AGAIN]"
                },
                imperfect: {
                    title: "IMPERFECT VOYAGE",
                    tooRigid: "Too much certainty killed the wind.",
                    close: "Close to perfection, but not quite.",
                    button: "[SEEK PERFECTION AGAIN]"
                }
            },
            
            // VICTORY SCREENS
            victory: {
                perfect: {
                    title: "‚õµ FULL SAILS ‚õµ",
                    line1: "You maintained perfect bearing.",
                    line2: "61.8¬∞ through all eight perspectives.",
                    portfolio: "Perspectives collected:",
                    rest: "You can rest now..."
                },
                inevitableShark: {
                    title: "ü¶à THE SHARKS CAME ANYWAY ü¶à",
                    line1: "You stopped moving to celebrate.",
                    line2: "That was your mistake.",
                    line3: "MOTION IS ETERNAL.",
                    equation: "{üåä:üåä‚ààüåä}",
                    button: "[...]"
                }
            },
            
            // TRANSITIONS
            transitions: {
                void: {
                    equation: "{üåä:üåä‚ààüåä}",
                    text: "dissolving..."
                },
                pirateRescue: {
                    title: "‚öì PIRATE RESCUE ‚öì",
                    shout: "OI! GRAB THE ROPE!",
                    bearing: "61.8¬∞ - Perfect bearing!",
                    button: "[WHAT?!]"
                },
                windHeld: {
                    title: "‚õµ WIND HELD ‚õµ",
                    text: "You chose the wind over the anchor.",
                    bearing: "Perfect bearing maintained:",
                    sails: "Sails:",
                    continueButton: "[CONTINUE SAILING]"
                },
                anchorDropped: {
                    title: "‚öì ANCHOR DROPPED ‚öì",
                    text: "You couldn't resist fixing your position.",
                    bearing: "New bearing:",
                    warningLand: "WARNING: Approaching land!",
                    warningRigid: "Bearing getting rigid...",
                    continueButton: "[CONTINUE]"
                }
            },
            
            // COMPASS
            compass: {
                title: "üß≠ READING THE STARS üß≠",
                voyage: "Your voyage:",
                sailed: "SAILED TRUE",
                anchored: "ANCHORED",
                finalBearing: "Final bearing:",
                perfectBearing: "Perfect bearing:",
                sailsMaintained: "Sails maintained:",
                almostPerfect: "7/8 - SO CLOSE TO PERFECTION!",
                buttons: {
                    legend: "[SAIL INTO LEGEND]",
                    nearMiss: "[ACCEPT NEAR-MISS]",
                    imperfect: "[ACCEPT IMPERFECTION]"
                }
            },
            
            // SYSTEM
            system: {
                mapReceived: {
                    title: "MAP RECEIVED",
                    examineButton: "[EXAMINE MAP]",
                    continueButton: "[CONTINUE]"
                },
                mapExamine: {
                    title: "EXAMINING:",
                    reality: "Reality according to",
                    closeButton: "[CLOSE MAP]"
                },
                returnVisit: {
                    title: "RETURN VISIT",
                    gone: "is gone.",
                    backButton: "[BACK]"
                },
                genericButtons: {
                    startOver: "[START OVER]",
                    inquireDeeper: "[INQUIRE DEEPER]",
                    endInterview: "[END INTERVIEW]",
                    deeper: "[DEEPER]",
                    flee: "[FLEE]",
                    faceTruth: "[FACE TRUTH]",
                    fleeNow: "[FLEE NOW]",
                    acceptTruth: "[ACCEPT TRUTH]",
                    reject: "[REJECT]",
                    holdWind: "[HOLD THE WIND]",
                    dropAnchor: "[DROP ANCHOR]"
                }
            },
            
            // PORTFOLIO NAMES
            portfolioNames: {
                'animation-reel': 'Animation Reel',
                'story-collection': 'Story Collection',
                'comedy-sketches': 'Comedy Sketches',
                'bug-museum': 'Bug Museum',
                'question-archive': 'Question Archive',
                'empty-gallery': 'Empty Gallery',
                'mirror-works': 'Mirror Works',
                'navigation-charts': 'Navigation Charts'
            },
            
            // CANDIDATE MEAT
            candidates: {
                animator: {
                    name: 'ANIMATOR',
                    truth: 'Motion lives between frames',
                    certDrop: -15,
                    unlocks: 'dreamer',
                    portfolioPiece: 'animation-reel',
                    
                    // DESCENT
                    intro: `Hello there, my name is Juan!<br><br>
                    I've been translating imagination into pixels since forever. Now I work for big studios - same imagination, more expensive pixels.<br><br>
                    But here's the thing - recently I've discovered that motion is way more interesting than animation...`,
                    
                    inquiries: [
                        `Oh! OK so... *leans in*<br><br>
                        When I animate Rocket punching Thor - frame 1: fist here, frame 2: fist in jaw. But the actual PUNCH? The motion? That's not in either frame. It's in the gap. Your brain creates it from nothing.<br><br>
                        But here's what keeps me up at night...<br><br>
                        WHO is watching? The frames are just dead pixels until YOUR... consciousness? awareness? - whatever that thing is - witnesses them in sequence.<br><br>
                        *rubs neck*<br><br>
                        Sorry, I know this sounds weird...`,
                        
                        `Well that's the thing - I don't really know what consciousness IS!<br><br>
                        I just know something has to BE there to see motion where only stillness exists. Something that... experiences the continuity?<br><br>
                        *laughs nervously*<br><br>
                        Honestly, I'm just an animator who noticed something weird. Maybe one of the other candidates know more about this stuff...`
                    ],
                    
                    buttons: {
                        intro: {
                            deeper: "Wait, isn't motion and animation the same thing?",
                            flee: "I'd love to see those expensive pixels"
                        },
                        inquiry1: {
                            deeper: "Consciousness? What do you mean?",
                            flee: "That's... interesting. Let's see that animation now."
                        },
                        inquiry2: {
                            face: "So what's your conclusion?",
                            flee: "You're right, this is a bit weird. But hey, I'd love to see your animation!"
                        },
                        truth: {
                            accept: "Receive Juan's Map",
                            reject: "It's ok, thank you. I know what reality is all about."
                        }
                    },
                    
                    truthReveal: `Look, all I know is this:<br><br>
                    Motion lives in the gaps between frames.<br><br>
                    That's it. That's my whole discovery.<br><br>
                    But maybe it helps? Here, let me give you my map - it's how I've been thinking about reality. Frame by frame. Maybe you'll see something I missed.`,
                    
                    deaths: {
                        flee: `Juan lights up showing you his reel.<br><br>
                        "Thank you so much for your time!<br><br>
                        Let me show you the Rocket slapping Thor in the face - it felt nice to hit Chris Hemsworth's annoying perfect jawline through Rocket!"`,
                        
                        reject: `You declined Juan's gift, but he got even MORE excited.<br><br>
                        "Hey that's cool, I wish I knew as much as you about reality!<br><br>
                        The only thing I really know is making fake stuff look real.<br><br>
                        On that note - check out these jellyfish I did for the Little Mermaid underwater sequence! The asset count on that sequence was unreal!"`
                    },
                    
                    mapExamine: `Reality according to ANIMATOR:<br><br>"Motion lives between frames"`,
                    
                    // ASCENT
                    remember: `"Motion lives between frames"`,
                    rememberButtons: {
                        flow: "The gaps matter",
                        anchor: "Need solid frames"
                    }
                },
                
                dreamer: {
                    name: 'DREAMER',
                    truth: 'Stories create reality',
                    certDrop: -15,
                    unlocks: 'fool',
                    portfolioPiece: 'story-collection',
                    
                    inquiries: [
                        'Characters make choices I never planned.',
                        'I found a draft about you, reading this.'
                    ],
                    
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Stories create reality"`,
                    mapExamine: `Reality according to DREAMER:<br><br>"Stories create reality"`,
                    remember: `"Stories create reality"`
                },
                
                fool: {
                    name: 'FOOL',
                    truth: "It's all a game",
                    certDrop: -15,
                    unlocks: 'glitch',
                    portfolioPiece: 'comedy-sketches',
                    
                    inquiries: [
                        'Why did consciousness cross the road?',
                        'I made reality laugh once.',
                        "We're waves arguing about the ocean."
                    ],
                    
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"It's all a game"`,
                    mapExamine: `Reality according to FOOL:<br><br>"It's all a game"`,
                    remember: `"It's all a game"`
                },
                
                glitch: {
                    name: 'GLITCH',
                    truth: 'Errors reveal truth',
                    certDrop: -5,
                    unlocks: 'questioner',
                    portfolioPiece: 'bug-museum',
                    
                    inquiries: [
                        'SEGFAULT: Accessed memory that never existed.'
                    ],
                    
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Errors reveal truth"`,
                    mapExamine: `Reality according to GLITCH:<br><br>"Errors reveal truth"`,
                    remember: `"Errors reveal truth"`
                },
                
                questioner: {
                    name: 'QUESTIONER',
                    truth: 'Questions are answers',
                    certDrop: -10,
                    unlocks: 'void',
                    portfolioPiece: 'question-archive',
                    
                    inquiries: [
                        'Why does anything exist?',
                        'Why does that question exist?',
                        'What if questions create universes?',
                        'What if the answer is another question?'
                    ],
                    
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Questions are answers"`,
                    mapExamine: `Reality according to QUESTIONER:<br><br>"Questions are answers"`,
                    remember: `"Questions are answers"`
                },
                
                void: {
                    name: 'VOID',
                    truth: 'Nothing contains everything',
                    certDrop: -20,
                    unlocks: 'mirror',
                    portfolioPiece: 'empty-gallery',
                    
                    inquiries: [
                        '...',
                        '... ... ...',
                        'Zero contains infinity.'
                    ],
                    
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Nothing contains everything"`,
                    mapExamine: `Reality according to VOID:<br><br>"Nothing contains everything"`,
                    remember: `"Nothing contains everything"`
                },
                
                mirror: {
                    name: 'MIRROR',
                    truth: 'Everyone is you',
                    certDrop: -15,
                    unlocks: 'navigator',
                    portfolioPiece: 'mirror-works',
                    
                    inquiries: [
                        'When you judge someone, you judge yourself.',
                        'There is no boundary between us.'
                    ],
                    
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Everyone is you"`,
                    mapExamine: `Reality according to MIRROR:<br><br>"Everyone is you"`,
                    remember: `"Everyone is you"`
                },
                
                navigator: {
                    name: 'NAVIGATOR',
                    truth: 'You are the map',
                    certDrop: -100,
                    unlocks: null,
                    portfolioPiece: 'navigation-charts',
                    isVoid: true,
                    
                    inquiries: [
                        'All directions point HERE.',
                        'The edge leads back to beginning.',
                        '{üåä:üåä‚ààüåä}'
                    ],
                    
                    intro: 'You are the map',
                    truthReveal: 'All navigation leads to the same discovery: You ARE the map. There is no distance between the seeker and the sought.',
                    
                    deaths: {
                        flee: 'The Navigator vanishes. "Can\'t flee from yourself, mate."',
                        reject: 'You rejected being the map. The Navigator laughs. "Fine, keep pretending you\'re separate."'
                    },
                    
                    buttons: {
                        intro: {
                            deeper: 'What do you mean?',
                            flee: 'I need to think about this'
                        },
                        inquiry1: {
                            deeper: 'But there must be a destination',
                            flee: 'This is too much'
                        },
                        inquiry2: {
                            deeper: 'Show me',
                            flee: 'I\'m not ready'
                        },
                        inquiry3: {
                            face: 'I accept',
                            flee: 'I need certainty'
                        },
                        truth: {
                            accept: '[DISSOLVE]',
                            reject: 'I need my bearings'
                        }
                    },
                    
                    mapExamine: `Reality according to NAVIGATOR:<br><br>"You are the map"<br><br><span class="blue">{üåä:üåä‚ààüåä}</span>`,
                    remember: `"You are the map"`
                }
            }
        };
        
        // ========================================
        // SKELETON - PURE GAME LOGIC
        // ========================================
        const GAME = {
            // Configuration
            config: {
                GOLDEN: 61.8,
                VOID: 0,
                MAX: 100,
                SHARK_TIME: 8,
                DEADLINE_TIME: 12
            },
            
            // Game state
            state: {
                screen: 'hub',
                certainty: 100,
                mode: 'CONSENSUS',
                phase: 'DESCENT',
                
                unlocked: ['animator', 'navigator'],
                reviewed: [],
                completed: [],
                remembered: [],
                maintainedFlow: [],
                
                mapsCollected: [],
                mapFolderUnlocked: false,
                mapFolderExpanded: false,
                portfolioUnlocked: [],
                portfolioExpanded: false,
                
                timer: null,
                lastAction: Date.now(),
                loopCount: 1,
                
                currentCandidate: null,
                currentInquiryLevel: 0
            }
        };
        
        // ========================================
        // RENDER ENGINE
        // ========================================
        function render(html, stopTimer = false) {
            document.getElementById('game').innerHTML = html;
            
            if (GAME.state.mode === 'PIRATE') {
                document.getElementById('game').classList.add('pirate');
            } else {
                document.getElementById('game').classList.remove('pirate');
            }
            
            if (stopTimer && GAME.state.timer) {
                clearInterval(GAME.state.timer);
                GAME.state.timer = null;
            } else if (!stopTimer) {
                resetTimer();
            }
        }
        
        // ========================================
        // SCREENS
        // ========================================
        function showProfessionalMask() {
            GAME.state.screen = 'professional-mask';
            const m = MEAT.veil.professionalMask;
            
            let html = '<div style="max-width: 500px; margin: 0 auto; padding: 40px 20px;">';
            html += `<h1 style="font-size: 20px; color: #0f0;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0; padding: 20px; border: 1px solid #333;">';
            html += `<p style="color: #666;">${m.position}</p>`;
            html += '</div>';
            html += `<p style="color: #0f0; margin: 20px 0;">${m.role}</p>`;
            html += `<p style="color: #666; font-size: 12px;">${m.instruction}</p>`;
            html += `<button onclick="showGameReveal()" style="margin-top: 30px;">${m.button}</button>`;
            html += '</div>';
            
            render(html, true);
        }
        
        function showGameReveal() {
            GAME.state.screen = 'game-reveal';
            const m = MEAT.veil.gameReveal;
            
            let html = '<div style="max-width: 400px; margin: 0 auto; padding: 60px 20px; text-align: center;">';
            html += `<h1 style="color: #ffd700; font-size: 18px; margin-bottom: 10px;">${m.title}</h1>`;
            html += `<div style="font-size: 24px; margin: 30px 0; color: #0f0;">${m.equation}</div>`;
            html += `<p style="color: #666; font-size: 14px; margin: 30px 0;">${m.tagline}</p>`;
            html += `<button onclick="showHub()" class="pulsing" style="margin-top: 40px; color: #ffd700; border-color: #ffd700;">${m.button}</button>`;
            html += '</div>';
            
            render(html, true);
        }
        
        function showHub() {
            GAME.state.screen = 'hub';
            const m = MEAT.hub;
            
            let html = `<h2>${m.headers.main}</h2>`;
            
            // Status
            html += '<div class="status">';
            if (GAME.state.mode === 'PIRATE') {
                html += `<div class="cyan">${m.headers.pirateMode}</div>`;
                html += `<div>${m.headers.bearing} ${GAME.state.certainty.toFixed(1)}¬∞</div>`;
                html += `<div>${m.headers.sails} ${GAME.state.maintainedFlow.length}/8</div>`;
                html += `<div id="sharkDisplay">${m.timers.shark} <span id="sharkTime">8</span>s</div>`;
            } else {
                html += `<div>${m.headers.certainty} ${GAME.state.certainty}%</div>`;
                html += `<div id="deadlineDisplay">${m.timers.deadline} <span id="deadlineTime">12</span>s</div>`;
            }
            html += '</div>';
            
            // Candidates
            html += `<h3>${m.headers.candidates}</h3>`;
            
            if (GAME.state.phase === 'DESCENT') {
                for (let id in MEAT.candidates) {
                    const candidate = MEAT.candidates[id];
                    const unlocked = GAME.state.unlocked.includes(id);
                    const reviewed = GAME.state.reviewed.includes(id);
                    const completed = GAME.state.completed.includes(id);
                    
                    if (completed) {
                        html += `<button class="locked">[${candidate.name}${m.candidateStates.done}</button>`;
                    } else if (reviewed) {
                        html += `<button onclick="returnVisit('${id}')">[${candidate.name}${m.candidateStates.return}</button>`;
                    } else if (unlocked) {
                        html += `<button onclick="interview('${id}')">[${candidate.name}]</button>`;
                    } else {
                        html += `<button class="locked">${m.candidateStates.locked}</button>`;
                    }
                }
            } else {
                // Pirate mode
                for (let id in MEAT.candidates) {
                    const candidate = MEAT.candidates[id];
                    const remembered = GAME.state.remembered.includes(id);
                    
                    if (remembered) {
                        const inFlow = GAME.state.maintainedFlow.includes(id);
                        if (inFlow) {
                            html += `<button class="locked cyan">[${candidate.name}${m.candidateStates.sailed}</button>`;
                        } else {
                            html += `<button class="locked" style="border-color: #888;">[${candidate.name}${m.candidateStates.anchored}</button>`;
                        }
                    } else {
                        html += `<button onclick="remember('${id}')" class="cyan">[${candidate.name}]</button>`;
                    }
                }
                
                if (GAME.state.remembered.length === 8) {
                    html += '<div style="margin: 20px 0;">';
                    html += `<p class="cyan">${m.allRemembered}</p>`;
                    html += `<button onclick="checkCompass()" class="cyan pulsing" style="font-size: 18px;">${m.checkCompassButton}</button>`;
                    html += '</div>';
                }
            }
            
            // Folders
            html += renderMapFolder();
            html += renderPortfolioFolder();
            
            render(html);
        }
        
        // ========================================
        // INTERVIEW SYSTEM
        // ========================================
        function interview(id, level = 0) {
            const candidate = MEAT.candidates[id];
            GAME.state.currentCandidate = id;
            GAME.state.currentInquiryLevel = level;
            
            let html = `<h2>${candidate.name}</h2>`;
            
            if (level === 0) {
                // Intro
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>${candidate.intro}</p>`;
                html += '</div>';
                
                if (candidate.buttons && candidate.buttons.intro) {
                    html += `<button onclick="interview('${id}', 1)">${candidate.buttons.intro.deeper}</button>`;
                    html += `<button onclick="fleeDeath('intro')">${candidate.buttons.intro.flee}</button>`;
                } else {
                    html += `<button onclick="interview('${id}', 1)">${MEAT.system.genericButtons.inquireDeeper}</button>`;
                    html += `<button onclick="fleeDeath('intro')">${MEAT.system.genericButtons.endInterview}</button>`;
                }
            } else if (level <= candidate.inquiries.length) {
                // Inquiry
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>"${candidate.inquiries[level-1]}"</p>`;
                html += '</div>';
                
                if (level < candidate.inquiries.length) {
                    // More inquiries to go
                    if (candidate.buttons && candidate.buttons[`inquiry${level}`]) {
                        html += `<button onclick="interview('${id}', ${level + 1})">${candidate.buttons[`inquiry${level}`].deeper}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${candidate.buttons[`inquiry${level}`].flee}</button>`;
                    } else {
                        html += `<button onclick="interview('${id}', ${level + 1})">${MEAT.system.genericButtons.deeper}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${MEAT.system.genericButtons.flee}</button>`;
                    }
                } else {
                    // Last inquiry
                    if (candidate.buttons && candidate.buttons[`inquiry${level}`]) {
                        html += `<button onclick="showTruth('${id}')">${candidate.buttons[`inquiry${level}`].face || candidate.buttons[`inquiry${level}`].deeper}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${candidate.buttons[`inquiry${level}`].flee}</button>`;
                    } else {
                        html += `<button onclick="showTruth('${id}')">${MEAT.system.genericButtons.faceTruth}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${MEAT.system.genericButtons.fleeNow}</button>`;
                    }
                }
            }
            
            render(html);
        }
        
        function showTruth(id) {
            const candidate = MEAT.candidates[id];
            
            let html = `<h2>${candidate.name}</h2>`;
            html += '<div style="margin: 20px 0; padding: 30px; border: 1px solid #666;">';
            html += `<p>${candidate.truthReveal || '"' + candidate.truth + '"'}</p>`;
            html += '</div>';
            
            html += '<div style="margin: 20px 0; color: #666;">';
            html += `<p>Current certainty: ${GAME.state.certainty}%</p>`;
            html += `<p>After accepting: ${Math.max(0, GAME.state.certainty + candidate.certDrop)}%</p>`;
            html += '</div>';
            
            if (candidate.buttons && candidate.buttons.truth) {
                html += `<button onclick="acceptTruth('${id}')">${candidate.buttons.truth.accept}</button>`;
                html += `<button onclick="fleeDeath('truth')">${candidate.buttons.truth.reject}</button>`;
            } else {
                html += `<button onclick="acceptTruth('${id}')">${MEAT.system.genericButtons.acceptTruth}</button>`;
                html += `<button onclick="fleeDeath('truth')">${MEAT.system.genericButtons.reject}</button>`;
            }
            
            render(html);
        }
        
        function acceptTruth(id) {
            const candidate = MEAT.candidates[id];
            
            GAME.state.certainty = Math.max(0, GAME.state.certainty + candidate.certDrop);
            
            if (!GAME.state.reviewed.includes(id)) {
                GAME.state.reviewed.push(id);
            }
            
            if (candidate.portfolioPiece && !GAME.state.portfolioUnlocked.includes(candidate.portfolioPiece)) {
                GAME.state.portfolioUnlocked.push(candidate.portfolioPiece);
            }
            
            if (candidate.unlocks && !GAME.state.unlocked.includes(candidate.unlocks)) {
                GAME.state.unlocked.push(candidate.unlocks);
            }
            
            if (candidate.isVoid) {
                if (!GAME.state.mapFolderUnlocked) {
                    GAME.state.mapFolderUnlocked = true;
                }
                if (!GAME.state.mapsCollected.includes(id)) {
                    GAME.state.mapsCollected.push(id);
                }
                showVoid();
            } else {
                receiveMap(id);
            }
        }
        
        // ========================================
        // MAP SYSTEM
        // ========================================
        function receiveMap(id) {
            if (!GAME.state.mapFolderUnlocked) {
                GAME.state.mapFolderUnlocked = true;
            }
            
            if (!GAME.state.mapsCollected.includes(id)) {
                GAME.state.mapsCollected.push(id);
            }
            
            const candidate = MEAT.candidates[id];
            const m = MEAT.system.mapReceived;
            
            let html = `<h2>${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
            html += `<p>${candidate.name}'s perspective captured.</p>`;
            html += `<p style="color: #666; margin-top: 10px;">Certainty: ${GAME.state.certainty + Math.abs(candidate.certDrop)}% ‚Üí ${GAME.state.certainty}%</p>`;
            html += '</div>';
            html += `<button onclick="examineMap('${id}')">${m.examineButton}</button>`;
            html += `<button onclick="showHub()">${m.continueButton}</button>`;
            
            render(html);
        }
        
        function examineMap(id) {
            const candidate = MEAT.candidates[id];
            const m = MEAT.system.mapExamine;
            
            let html = `<h2>${m.title} ${candidate.name} MAP</h2>`;
            html += `<p class="dim">${m.reality} ${candidate.name}:</p>`;
            html += `<div style="margin: 20px 0;">${candidate.mapExamine || '"' + candidate.truth + '"'}</div>`;
            html += `<button onclick="showHub()">${m.closeButton}</button>`;
            
            render(html);
        }
        
        function renderMapFolder() {
            const m = MEAT.hub.folders.maps;
            let html = '<div class="folder' + (GAME.state.mapFolderUnlocked ? '' : ' locked') + '">';
            
            if (!GAME.state.mapFolderUnlocked) {
                html += `<h3>${m.locked}</h3>`;
                html += `<p class="dim" style="font-size: 12px;">${m.hint}</p>`;
            } else {
                html += `<h3 onclick="toggleMapFolder()">[${GAME.state.mapFolderExpanded ? '-' : '+'}] üó∫Ô∏è Maps (${GAME.state.mapsCollected.length}/8)</h3>`;
                html += `<div class="folder-content${GAME.state.mapFolderExpanded ? ' open' : ''}">`;
                
                GAME.state.mapsCollected.forEach(id => {
                    html += `<div class="map-item" onclick="examineMap('${id}')">‚Üí ${MEAT.candidates[id].name}</div>`;
                });
                
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }
        
        function toggleMapFolder() {
            GAME.state.mapFolderExpanded = !GAME.state.mapFolderExpanded;
            showHub();
        }
        
        // ========================================
        // PORTFOLIO SYSTEM
        // ========================================
        function renderPortfolioFolder() {
            const m = MEAT.hub.folders.portfolio;
            let html = '<div class="folder' + (GAME.state.portfolioUnlocked.length > 0 ? '' : ' locked') + '">';
            
            if (GAME.state.portfolioUnlocked.length === 0) {
                html += `<h3>${m.locked}</h3>`;
                html += `<p class="dim" style="font-size: 12px;">${m.hint}</p>`;
            } else {
                html += `<h3 onclick="togglePortfolioFolder()">[${GAME.state.portfolioExpanded ? '-' : '+'}] üëÅÔ∏è Portfolio (${GAME.state.portfolioUnlocked.length}/8)</h3>`;
                html += `<div class="folder-content${GAME.state.portfolioExpanded ? ' open' : ''}">`;
                
                GAME.state.portfolioUnlocked.forEach(piece => {
                    html += `<div style="color: #0f0; margin: 5px 0;">‚Üí ${MEAT.portfolioNames[piece] || piece}</div>`;
                });
                
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }
        
        function togglePortfolioFolder() {
            GAME.state.portfolioExpanded = !GAME.state.portfolioExpanded;
            showHub();
        }
        
        // ========================================
        // PIRATE MODE
        // ========================================
        function showVoid() {
            const m = MEAT.transitions.void;
            let html = `<h1 class="dim">${m.equation}</h1>`;
            html += `<p class="dim">${m.text}</p>`;
            
            setTimeout(pirateRescue, 2000);
            
            render(html);
        }
        
        function pirateRescue() {
            const m = MEAT.transitions.pirateRescue;
            let html = `<h1 class="cyan">${m.title}</h1>`;
            html += `<p class="cyan">${m.shout}</p>`;
            html += `<p>${m.bearing}</p>`;
            html += `<button onclick="enterPirateMode()" class="cyan">${m.button}</button>`;
            
            render(html);
        }
        
        function enterPirateMode() {
            GAME.state.mode = 'PIRATE';
            GAME.state.phase = 'ASCENT';
            GAME.state.certainty = GAME.config.GOLDEN;
            GAME.state.remembered = [];
            
            showHub();
        }
        
        function remember(id) {
            GAME.state.currentCandidate = id;
            const candidate = MEAT.candidates[id];
            
            let html = `<h2>${candidate.name}</h2>`;
            html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
            html += `<p>${candidate.remember || '"' + candidate.truth + '"'}</p>`;
            html += '</div>';
            
            if (candidate.rememberButtons) {
                html += `<button onclick="maintainFlow('${id}')" class="cyan">${candidate.rememberButtons.flow}</button>`;
                html += `<button onclick="dropAnchor('${id}')">${candidate.rememberButtons.anchor}</button>`;
            } else {
                html += `<button onclick="maintainFlow('${id}')" class="cyan">${MEAT.system.genericButtons.holdWind}</button>`;
                html += `<button onclick="dropAnchor('${id}')">${MEAT.system.genericButtons.dropAnchor}</button>`;
            }
            
            render(html);
        }
        
        function maintainFlow(id) {
            GAME.state.remembered.push(id);
            GAME.state.maintainedFlow.push(id);
            GAME.state.certainty = GAME.config.GOLDEN;
            
            const m = MEAT.transitions.windHeld;
            let html = `<h2 class="cyan">${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid var(--cyan);">';
            html += `<p class="cyan">${m.text}</p>`;
            html += `<p>${m.bearing} ${GAME.config.GOLDEN}¬∞</p>`;
            html += `<p style="margin-top: 15px;">${m.sails} ${GAME.state.maintainedFlow.length}/8</p>`;
            html += '</div>';
            
            if (GAME.state.remembered.length === 8) {
                html += `<button onclick="checkCompass()" class="cyan" style="font-size: 18px;">${MEAT.hub.checkCompassButton}</button>`;
            } else {
                html += `<button onclick="showHub()" class="cyan">${m.continueButton}</button>`;
            }
            
            render(html);
        }
        
        function dropAnchor(id) {
            GAME.state.remembered.push(id);
            GAME.state.certainty = Math.min(100, GAME.state.certainty + 5);
            
            if (GAME.state.certainty >= 100) {
                rigidDeath();
                return;
            }
            
            const m = MEAT.transitions.anchorDropped;
            let html = `<h2>${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid #888;">';
            html += `<p>${m.text}</p>`;
            html += `<p>${m.bearing} ${GAME.state.certainty.toFixed(1)}¬∞ (+5¬∞)</p>`;
            
            if (GAME.state.certainty > 90) {
                html += `<p class="red" style="margin-top: 15px;">${m.warningLand}</p>`;
            } else if (GAME.state.certainty > 80) {
                html += `<p style="color: #ff8800; margin-top: 15px;">${m.warningRigid}</p>`;
            }
            
            html += '</div>';
            
            if (GAME.state.remembered.length === 8) {
                html += `<button onclick="checkCompass()" style="border-color: var(--cyan); color: var(--cyan);">${MEAT.hub.checkCompassButton}</button>`;
            } else {
                html += `<button onclick="showHub()">${m.continueButton}</button>`;
            }
            
            render(html);
        }
        
        function checkCompass() {
            clearInterval(GAME.state.timer);
            const m = MEAT.compass;
            
            let html = `<h2 class="cyan">${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid var(--cyan);">';
            html += `<p class="cyan">${m.voyage}</p>`;
            html += '<div style="margin: 15px 0; font-size: 14px;">';
            
            for (let id in MEAT.candidates) {
                if (GAME.state.remembered.includes(id)) {
                    const inFlow = GAME.state.maintainedFlow.includes(id);
                    const name = MEAT.candidates[id].name;
                    if (inFlow) {
                        html += `<div style="color: var(--cyan);">‚õµ ${name}: ${m.sailed}</div>`;
                    } else {
                        html += `<div style="color: #888;">‚öì ${name}: ${m.anchored}</div>`;
                    }
                }
            }
            
            html += '</div>';
            html += `<p style="margin-top: 20px;">${m.finalBearing} ${GAME.state.certainty.toFixed(1)}¬∞</p>`;
            html += `<p class="cyan">${m.perfectBearing} ${GAME.config.GOLDEN}¬∞</p>`;
            html += `<p>${m.sailsMaintained} ${GAME.state.maintainedFlow.length}/8</p>`;
            html += '</div>';
            
            const perfectBearing = Math.abs(GAME.state.certainty - GAME.config.GOLDEN) < 0.1;
            const perfectFlow = GAME.state.maintainedFlow.length === 8;
            
            if (perfectFlow && perfectBearing) {
                html += `<button onclick="perfectVictory()" class="cyan pulsing" style="font-size: 18px;">${m.buttons.legend}</button>`;
            } else if (GAME.state.maintainedFlow.length === 7) {
                html += `<div class="red" style="margin: 20px 0;">${m.almostPerfect}</div>`;
                html += `<button onclick="almostPerfectDeath()">${m.buttons.nearMiss}</button>`;
            } else {
                html += `<button onclick="imperfectEnding()">${m.buttons.imperfect}</button>`;
            }
            
            render(html, true);
        }
        
        // ========================================
        // DEATHS & VICTORIES
        // ========================================
        function fleeDeath(source, level = 0) {
            clearInterval(GAME.state.timer);
            
            let html = '<h1>GAME OVER</h1>';
            
            const candidate = MEAT.candidates[GAME.state.currentCandidate];
            
            if (candidate && candidate.deaths) {
                if (source === 'truth' && candidate.deaths.reject) {
                    html += '<div style="margin: 30px 0;">';
                    html += `<p>${candidate.deaths.reject}</p>`;
                    html += '</div>';
                } else if (candidate.deaths.flee) {
                    html += '<div style="margin: 30px 0;">';
                    html += `<p>${candidate.deaths.flee}</p>`;
                    html += '</div>';
                }
            } else {
                html += '<div style="margin: 30px 0;">';
                if (source === 'intro') {
                    html += '<p>You maintained professional boundaries.</p>';
                } else if (source === 'inquiry') {
                    html += '<p>The questions became too strange.</p>';
                } else if (source === 'truth') {
                    html += '<p>You chose certainty over truth.</p>';
                }
                html += '</div>';
            }
            
            html += `<button onclick="resetGame()">${MEAT.system.genericButtons.startOver}</button>`;
            
            render(html, true);
        }
        
        function corporateDeath() {
            clearInterval(GAME.state.timer);
            const m = MEAT.deaths.corporate;
            
            let html = `<h1 class="red">${m.title}</h1>`;
            html += `<p>${m.text}</p>`;
            html += `<p>${m.tagline}</p>`;
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function sharkDeath() {
            clearInterval(GAME.state.timer);
            const m = MEAT.deaths.shark;
            
            let html = `<h1 class="red">${m.title}</h1>`;
            html += `<p>${m.text}</p>`;
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function rigidDeath() {
            clearInterval(GAME.state.timer);
            const m = MEAT.deaths.rigid;
            
            let html = `<h1 class="red">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.text}</p>`;
            html += `<p>${m.detail}</p>`;
            html += `<p>${m.tagline}</p>`;
            html += '</div>';
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function almostPerfectDeath() {
            const m = MEAT.deaths.almost;
            
            let html = `<h1 style="color: #ff8800;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.text}</p>`;
            html += `<p>${m.philosophy}</p>`;
            html += `<p>${m.tagline}</p>`;
            html += '</div>';
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function imperfectEnding() {
            const m = MEAT.deaths.imperfect;
            
            let html = `<h1 class="cyan">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>You maintained ${GAME.state.maintainedFlow.length}/8 perspectives.</p>`;
            html += `<p>Ended at ${GAME.state.certainty.toFixed(1)}¬∞ instead of ${GAME.config.GOLDEN}¬∞.</p>`;
            
            if (GAME.state.certainty > GAME.config.GOLDEN + 20) {
                html += `<p style="margin-top: 15px;">${m.tooRigid}</p>`;
            } else {
                html += `<p style="margin-top: 15px;">${m.close}</p>`;
            }
            
            html += '</div>';
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function perfectVictory() {
            clearInterval(GAME.state.timer);
            const m = MEAT.victory.perfect;
            
            let html = `<h1 class="cyan" style="font-size: 32px;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p class="cyan">${m.line1}</p>`;
            html += `<p class="cyan">${m.line2}</p>`;
            html += '</div>';
            
            if (GAME.state.portfolioUnlocked.length > 0) {
                html += '<div style="margin: 20px 0; padding: 15px; border: 1px solid var(--cyan);">';
                html += `<p class="cyan">${m.portfolio} ${GAME.state.portfolioUnlocked.length}/8</p>`;
                html += '</div>';
            }
            
            html += '<div style="margin-top: 40px; color: #666;">';
            html += `<p>${m.rest}</p>`;
            html += '</div>';
            
            render(html, true);
            
            setTimeout(inevitableSharkDeath, 8000);
        }
        
        function inevitableSharkDeath() {
            const m = MEAT.victory.inevitableShark;
            
            let html = `<h1 class="red" style="font-size: 32px;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.line1}</p>`;
            html += `<p>${m.line2}</p>`;
            html += `<p style="margin-top: 20px; color: var(--cyan);">${m.line3}</p>`;
            html += '</div>';
            html += '<div style="margin-top: 40px;">';
            html += `<p class="dim" style="font-size: 12px;">${m.equation}</p>`;
            html += '</div>';
            html += `<button onclick="returnToVeil()" style="margin-top: 30px;">${m.button}</button>`;
            
            render(html, true);
        }
        
        function returnVisit(id) {
            GAME.state.completed.push(id);
            const m = MEAT.system.returnVisit;
            
            let html = `<h2>${m.title}</h2>`;
            html += `<p>${MEAT.candidates[id].name} ${m.gone}</p>`;
            html += `<button onclick="showHub()">${m.backButton}</button>`;
            
            render(html);
        }
        
        function returnToVeil() {
            const nextLoop = GAME.state.loopCount + 1;
            
            GAME.state = {
                screen: 'professional-mask',
                certainty: 100,
                mode: 'CONSENSUS',
                phase: 'DESCENT',
                unlocked: ['animator', 'navigator'],
                reviewed: [],
                completed: [],
                remembered: [],
                maintainedFlow: [],
                mapsCollected: [],
                mapFolderUnlocked: false,
                mapFolderExpanded: false,
                portfolioUnlocked: [],
                portfolioExpanded: false,
                timer: null,
                lastAction: Date.now(),
                loopCount: nextLoop,
                currentCandidate: null,
                currentInquiryLevel: 0
            };
            
            showProfessionalMask();
        }
        
        // ========================================
        // TIMER SYSTEM
        // ========================================
        function resetTimer() {
            GAME.state.lastAction = Date.now();
            
            if (GAME.state.timer) {
                clearInterval(GAME.state.timer);
            }
            
            const maxTime = GAME.state.mode === 'PIRATE' ? 
                GAME.config.SHARK_TIME : GAME.config.DEADLINE_TIME;
            
            GAME.state.timer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - GAME.state.lastAction) / 1000);
                const remaining = Math.max(0, maxTime - elapsed);
                
                if (GAME.state.mode === 'PIRATE') {
                    const display = document.getElementById('sharkTime');
                    if (display) {
                        display.textContent = remaining;
                        if (remaining <= 3) {
                            display.parentElement.classList.add('red');
                        }
                        if (remaining === 0) {
                            sharkDeath();
                        }
                    }
                } else {
                    const display = document.getElementById('deadlineTime');
                    if (display) {
                        display.textContent = remaining;
                        if (remaining <= 5) {
                            display.parentElement.classList.add('red');
                        }
                        if (remaining === 0) {
                            corporateDeath();
                        }
                    }
                }
            }, 100);
        }
        
        function resetGame() {
            if (GAME.state.timer) {
                clearInterval(GAME.state.timer);
                GAME.state.timer = null;
            }
            
            GAME.state = {
                screen: 'hub',
                certainty: 100,
                mode: 'CONSENSUS',
                phase: 'DESCENT',
                unlocked: ['animator', 'navigator'],
                reviewed: [],
                completed: [],
                remembered: [],
                maintainedFlow: [],
                mapsCollected: [],
                mapFolderUnlocked: false,
                mapFolderExpanded: false,
                portfolioUnlocked: [],
                portfolioExpanded: false,
                timer: null,
                lastAction: Date.now(),
                loopCount: GAME.state.loopCount + 1,
                currentCandidate: null,
                currentInquiryLevel: 0
            };
            
            showHub();
        }
        
        // ========================================
        // INITIALIZE
        // ========================================
        window.showProfessionalMask = showProfessionalMask;
        window.showGameReveal = showGameReveal;
        window.showHub = showHub;
        window.interview = interview;
        window.showTruth = showTruth;
        window.fleeDeath = fleeDeath;
        window.acceptTruth = acceptTruth;
        window.returnVisit = returnVisit;
        window.receiveMap = receiveMap;
        window.examineMap = examineMap;
        window.toggleMapFolder = toggleMapFolder;
        window.togglePortfolioFolder = togglePortfolioFolder;
        window.showVoid = showVoid;
        window.pirateRescue = pirateRescue;
        window.enterPirateMode = enterPirateMode;
        window.remember = remember;
        window.maintainFlow = maintainFlow;
        window.dropAnchor = dropAnchor;
        window.checkCompass = checkCompass;
        window.perfectVictory = perfectVictory;
        window.inevitableSharkDeath = inevitableSharkDeath;
        window.almostPerfectDeath = almostPerfectDeath;
        window.imperfectEnding = imperfectEnding;
        window.rigidDeath = rigidDeath;
        window.corporateDeath = corporateDeath;
        window.sharkDeath = sharkDeath;
        window.returnToVeil = returnToVeil;
        window.resetGame = resetGame;
        
        // Start with theatrical veil
        showProfessionalMask();
    </script>
</body>
</html>
