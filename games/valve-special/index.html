<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONSCIOUSNESS LOOP</title>
    <style>
        :root {
            --green: #00ff00;
            --gold: #ffd700;
            --red: #ff0000;
            --blue: #0080ff;
            --cyan: #00ffff;
            --purple: #9945ff;
            --dark: #111111;
            --gray: #666666;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: monospace;
            background: #000;
            color: #ccc;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        #game {
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        h1 { margin: 20px 0; font-size: 24px; color: var(--green); }
        h2 { margin: 15px 0; font-size: 18px; color: var(--green); }
        p { margin: 10px 0; line-height: 1.6; font-size: 16px; }
        button {
            background: #000;
            color: var(--green);
            border: 1px solid var(--green);
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: monospace;
            font-size: 14px;
            width: 100%;
            max-width: 400px;
        }
        button:hover {
            background: var(--green);
            color: #000;
        }
        button.locked {
            opacity: 0.3;
            cursor: not-allowed;
        }
        button.locked:hover {
            background: #000;
            color: var(--green);
        }
        .gold { color: var(--gold) !important; border-color: var(--gold) !important; }
        .red { color: var(--red) !important; border-color: var(--red) !important; }
        .blue { color: var(--blue) !important; border-color: var(--blue) !important; }
        .cyan { color: var(--cyan) !important; border-color: var(--cyan) !important; }
        .dim { opacity: 0.5; }
        .status {
            border: 1px solid var(--green);
            padding: 10px;
            margin: 20px 0;
            color: var(--green);
        }
        .folder {
            margin: 20px 0;
            padding: 15px 0;
            border-top: 1px solid #333;
        }
        .folder h3 {
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }
        .folder.locked h3 {
            color: #333;
            cursor: default;
        }
        .folder-content {
            margin: 10px 0 0 20px;
            display: none;
        }
        .folder-content.open {
            display: block;
        }
        .map-item {
            color: var(--green);
            cursor: pointer;
            margin: 5px 0;
        }
        .map-item:hover {
            color: var(--gold);
        }
        .pirate h1 { color: var(--cyan); }
        .pirate h2 { color: var(--cyan); }
        .pirate .status { border-color: var(--cyan); color: var(--cyan); }
        .pirate button { border-color: var(--cyan); color: var(--cyan); }
        .pirate button:hover { background: var(--cyan); color: #000; border-color: var(--cyan); }
        .pirate button.locked { opacity: 0.3; }
        .pirate button.locked:hover { background: #000; color: var(--cyan); }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .pulsing { animation: pulse 2s infinite; }
    </style>
</head>
<body>
    <div id="game"></div>
    
    <script>
        const MEAT = {
            ascii: {
                gameOver: `<pre style="color: #ff0000; font-size: 14px; font-weight: bold; text-align: center;">
 ██████╗  █████╗ ███╗   ███╗███████╗     ██████╗ ██╗   ██╗███████╗██████╗ 
██╔════╝ ██╔══██╗████╗ ████║██╔════╝    ██╔═══██╗██║   ██║██╔════╝██╔══██╗
██║  ███╗███████║██╔████╔██║█████╗      ██║   ██║██║   ██║█████╗  ██████╔╝
██║   ██║██╔══██║██║╚██╔╝██║██╔══╝      ██║   ██║╚██╗ ██╔╝██╔══╝  ██╔══██╗
╚██████╔╝██║  ██║██║ ╚═╝ ██║███████╗    ╚██████╔╝ ╚████╔╝ ███████╗██║  ██║
 ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝     ╚═════╝   ╚═══╝  ╚══════╝╚═╝  ╚═╝
</pre>`
            },
            
            ui: {
                gameOver: "GAME OVER",
                arrow: "→",
                openBracket: "[",
                closeBracket: "]",
                dash: " - ",
                slash: "/",
                colon: ":",
                percent: "%",
                degree: "°",
                seconds: "s",
                plus: "+",
                equation: "{🌊:🌊∈🌊}"
            },
            
            veil: {
                professionalMask: {
                    title: "VALVE CORPORATION",
                    position: "Position: ANIMATOR",
                    role: "Your role: Application Reviewer",
                    instruction: "Evaluate candidate portfolio and qualifications.",
                    button: "[BEGIN REVIEW]"
                },
                gameReveal: {
                    title: "CONSCIOUSNESS GAMES",
                    tagline: "The game plays you",
                    button: "[ENTER]"
                }
            },
            
            hub: {
                title: "APPLICATION REVIEW HUB",
                candidatesLabel: "CANDIDATES:",
                pirateMode: "PIRATE MODE",
                bearing: "Bearing:",
                sails: "Sails:",
                certainty: "Certainty:",
                deadline: "⏱️",
                shark: "🦈",
                
                candidateStates: {
                    locked: "[LOCKED]",
                    done: " - DONE]",
                    return: " - RETURN]",
                    sailed: " - ⛵ SAILED]",
                    anchored: " - ⚓ ANCHORED]"
                },
                
                allRemembered: "All eight perspectives remembered...",
                checkCompass: "[CHECK YOUR COMPASS]",
                
                maps: {
                    locked: "[🗺️] Reality Maps - LOCKED",
                    lockHint: "Complete interviews to collect",
                    prefix: "🗺️ Maps",
                    counter: "/8"
                },
                
                portfolio: {
                    locked: "[👁️] Portfolio - EMPTY",
                    lockHint: "Collect perspectives from candidates",
                    prefix: "👁️ Portfolio",
                    counter: "/8"
                }
            },
            
            interview: {
                quitOption: "Would you like to know more about their perspective?",
                inquireDeeper: "[INQUIRE DEEPER]",
                endInterview: "[END INTERVIEW]",
                deeper: "[DEEPER]",
                flee: "[FLEE]",
                faceTruth: "[FACE TRUTH]",
                fleeNow: "[FLEE NOW]",
                acceptTruth: "[ACCEPT TRUTH]",
                reject: "[REJECT]",
                
                certaintyPrefix: "Current certainty:",
                certaintyAfter: "After accepting:",
                
                fleeReasons: {
                    intro: "You maintained professional boundaries.",
                    inquiry: "The questions became too strange.",
                    truth: "You chose certainty over truth."
                }
            },
            
            map: {
                received: "MAP RECEIVED",
                captured: "'s perspective captured.",
                certaintyLabel: "Certainty:",
                examine: "[EXAMINE MAP]",
                continue: "[CONTINUE]",
                
                examining: "EXAMINING:",
                mapSuffix: " MAP",
                realityPrefix: "Reality according to",
                close: "[CLOSE MAP]"
            },
            
            pirate: {
                void: {
                    dissolving: "dissolving..."
                },
                rescue: {
                    title: "⚓ PIRATE RESCUE ⚓",
                    shout: "OI! GRAB THE ROPE!",
                    bearing: "61.8° - Perfect bearing!",
                    button: "[WHAT?!]"
                },
                windHeld: {
                    title: "⛵ WIND HELD ⛵",
                    text: "You chose the wind over the anchor.",
                    bearing: "Perfect bearing maintained:",
                    sails: "Sails:",
                    continue: "[CONTINUE SAILING]"
                },
                anchorDropped: {
                    title: "⚓ ANCHOR DROPPED ⚓",
                    text: "You couldn't resist fixing your position.",
                    bearing: "New bearing:",
                    increase: "(+5°)",
                    warningLand: "WARNING: Approaching land!",
                    warningRigid: "Bearing getting rigid...",
                    continue: "[CONTINUE]"
                },
                
                holdWind: "[HOLD THE WIND]",
                dropAnchor: "[DROP ANCHOR]"
            },
            
            compass: {
                title: "🧭 READING THE STARS 🧭",
                voyage: "Your voyage:",
                sailSymbol: "⛵",
                anchorSymbol: "⚓",
                sailed: "SAILED TRUE",
                anchored: "ANCHORED",
                finalBearing: "Final bearing:",
                perfectBearing: "Perfect bearing:",
                sailsMaintained: "Sails maintained:",
                almostPerfect: "7/8 - SO CLOSE TO PERFECTION!",
                legend: "[SAIL INTO LEGEND]",
                nearMiss: "[ACCEPT NEAR-MISS]",
                imperfect: "[ACCEPT IMPERFECTION]"
            },
            
            victory: {
                perfect: {
                    title: "⛵ FULL SAILS ⛵",
                    line1: "You maintained perfect bearing.",
                    line2: "61.8° through all eight perspectives.",
                    portfolioLabel: "Perspectives collected:",
                    rest: "You can rest now..."
                },
                shark: {
                    title: "🦈 THE SHARKS CAME ANYWAY 🦈",
                    line1: "You stopped moving to celebrate.",
                    line2: "That was your mistake.",
                    line3: "MOTION IS ETERNAL.",
                    button: "[...]"
                }
            },
            
            deaths: {
                corporate: {
                    title: "",
                    text: "Your review privileges have been revoked.",
                    tagline: "Productivity is everything.",
                    button: "[RESTART]"
                },
                shark: {
                    title: "🦈 SHARKS 🦈",
                    text: "You stopped moving.",
                    button: "[RESTART]"
                },
                rigid: {
                    title: "❄️ FROZEN DEATH ❄️",
                    text: "100° bearing in Pirate Reality.",
                    detail: "You became completely rigid.",
                    tagline: "The wind cannot move frozen sails.",
                    button: "[SHATTER AND RESTART]"
                },
                almost: {
                    title: "ALMOST PERFECT",
                    text: "7 perfect choices. 1 moment of weakness.",
                    philosophy: "That's how consciousness works.",
                    tagline: "One grasp and the flow breaks.",
                    button: "[TRY FOR PERFECTION AGAIN]"
                },
                imperfect: {
                    title: "IMPERFECT VOYAGE",
                    perspectives: "You maintained",
                    perspectivesOf: "perspectives.",
                    ended: "Ended at",
                    insteadOf: "instead of",
                    tooRigid: "Too much certainty killed the wind.",
                    close: "Close to perfection, but not quite.",
                    button: "[SEEK PERFECTION AGAIN]"
                }
            },
            
            returnVisit: {
                title: "RETURN VISIT",
                gone: "is gone.",
                back: "[BACK]"
            },
            
            startOver: "[START OVER]",
            
            portfolioNames: {
                'animation-reel': 'Animation Reel',
                'story-collection': 'Story Collection',
                'comedy-sketches': 'Comedy Sketches',
                'bug-museum': 'Bug Museum',
                'question-archive': 'Question Archive',
                'empty-gallery': 'Empty Gallery',
                'mirror-works': 'Mirror Works',
                'navigation-charts': 'Navigation Charts'
            },
            
            candidates: {
                animator: {
                    name: 'ANIMATOR',
                    truth: 'Motion lives between frames',
                    certDrop: -15,
                    unlocks: 'dreamer',
                    portfolioPiece: 'animation-reel',
                    
                    intro: `Hello there, my name is Juan!<br><br>
                    I've been translating imagination into pixels since I was a kid. Now I work for big studios - same imagination, more expensive pixels.<br><br>
                    But here's the thing - recently I've discovered that motion is way more interesting than animation...`,
                    
                    inquiries: [
                        `Oh! OK so... *leans in*<br><br>
                        When I animate Rocket punching Thor - frame 1: fist here, frame 2: fist in jaw. But the actual PUNCH? The motion? That's not in either frame. It's in the gap. Your brain creates it from nothing.<br><br>
                        But here's what keeps me up at night...<br><br>
                        WHO is watching? The frames are just dead pixels until YOUR... consciousness? awareness? - whatever that thing is - witnesses them in sequence.<br><br>
                        *rubs neck*<br><br>
                        Sorry, I know this sounds weird...`,
                        
                        `Well that's the thing - I don't really know what consciousness IS!<br><br>
                        I just know something has to BE there to see motion where only stillness exists. Something that... experiences the continuity?<br><br>
                        *laughs nervously*<br><br>
                        Honestly, I'm just an animator who noticed something weird. Maybe one of the other candidates know more about this stuff...`
                    ],
                    
                    buttons: {
                        intro: {
                            deeper: "Wait, isn't motion and animation the same thing?",
                            flee: "I'd love to see those expensive pixels"
                        },
                        inquiry1: {
                            deeper: "Consciousness? What do you mean?",
                            flee: "That's... interesting. Let's see that animation now."
                        },
                        inquiry2: {
                            face: "So what's your conclusion?",
                            flee: "You're right, this is a bit weird. But hey, I'd love to see your animation!"
                        },
                        truth: {
                            accept: "Receive Juan's Map",
                            reject: "It's ok, thank you. I know what reality is all about."
                        }
                    },
                    
                    truthReveal: `Look, all I know is this:<br><br>
                    Motion lives in the gaps between frames.<br><br>
                    That's it. That's my whole discovery.<br><br>
                    But maybe it helps? Here, let me give you my map - it's how I've been thinking about reality. Frame by frame. Maybe you'll see something I missed.`,
                    
                    deaths: {
                        flee: `Juan lights up showing you his reel.<br><br>
                        "Thank you so much for your time!<br><br>
                        Let me show you the Rocket slapping Thor in the face - it felt nice to hit Chris Hemsworth's annoying perfect jawline through Rocket!"`,
                        
                        reject: `You declined Juan's gift, but he got even MORE excited.<br><br>
                        "Hey that's cool, I wish I knew as much as you about reality!<br><br>
                        The only thing I really know is making fake stuff look real.<br><br>
                        On that note - check out these jellyfish I did for the Little Mermaid underwater sequence! The asset count on that sequence was unreal!"`
                    },
                    
                    mapReceived: `This is the map everyone uses. What we all learned.<br><br>
                    According to this map...<br>
                    Reality is matter and energy. Nothing else.<br>
                    Consciousness? Just neurons firing patterns.<br>
                    Love? Dopamine hits. Death? Atoms dispersing.<br>
                    Free will? Illusion. Soul? Superstition.<br>
                    Everything reducible to physics equations.<br><br>
                    This map built our entire world.<br>
                    Every cure. Every machine. Every animated frame.<br>
                    I trust it completely. Why wouldn't I?<br>
                    It WORKS. Perfectly. Predictably.<br><br>
                    It's just...<br><br>
                    *pauses*<br><br>
                    'Neurons firing patterns.' That's what creates consciousness?<br>
                    But if that's true... what's experiencing the neurons?<br>
                    The neurons can't watch themselves firing, right?<br><br>
                    *shakes head*<br><br>
                    Probably nothing. The map must be right.<br><br>
                    There's another candidate here.<br>
                    They see things... differently.<br>
                    Maybe they can explain it better.`,
                    
                    mapExamine: {
                        asciiArt: `<pre style="color: #9945ff; font-size: 14px; font-weight: bold; text-align: center;">
███████╗██████╗  █████╗ ███╗   ███╗███████╗    ██████╗ ██╗   ██╗    
██╔════╝██╔══██╗██╔══██╗████╗ ████║██╔════╝    ██╔══██╗╚██╗ ██╔╝    
█████╗  ██████╔╝███████║██╔████╔██║█████╗      ██████╔╝ ╚████╔╝     
██╔══╝  ██╔══██╗██╔══██║██║╚██╔╝██║██╔══╝      ██╔══██╗  ╚██╔╝      
██║     ██║  ██║██║  ██║██║ ╚═╝ ██║███████╗    ██████╔╝   ██║       
╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝    ╚═════╝    ╚═╝       
                                                                      
███████╗██████╗  █████╗ ███╗   ███╗███████╗    ███╗   ███╗ █████╗ ██████╗ 
██╔════╝██╔══██╗██╔══██╗████╗ ████║██╔════╝    ████╗ ████║██╔══██╗██╔══██╗
█████╗  ██████╔╝███████║██╔████╔██║█████╗      ██╔████╔██║███████║██████╔╝
██╔══╝  ██╔══██╗██╔══██║██║╚██╔╝██║██╔══╝      ██║╚██╔╝██║██╔══██║██╔═══╝ 
██║     ██║  ██║██║  ██║██║ ╚═╝ ██║███████╗    ██║ ╚═╝ ██║██║  ██║██║     
╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝    ╚═╝     ╚═╝╚═╝  ╚═╝╚═╝     
</pre>`,
                        subtitle: `<h3 style="color: #666; text-align: center; margin: 20px 0;">The Cartographers</h3>`,
                        body: `<div style="font-size: 16px; line-height: 1.8;">
<strong>DEMOCRITUS (460 BCE) - First Pirate to Sail These Waters</strong><br>
The mad bastard's discovery: 'Everything's atoms in void!' Revolutionary! Demolished the gods!<br>
His brilliant move: Even invented special round 'soul atoms' - consciousness as finest matter<br>
Where he earned respect: His own atoms told him: 'Wretched Mind, you overthrow us with evidence you got from us?'<br>
⚠️ Navigator's Note: First sailor to spot the paradox! Respect to the ancient Greek pirate!<br><br>

<strong>NEWTON - The Secret Alchemist Who Mapped the Heavens</strong><br>
His gift to pirates everywhere: Made the universe calculable! Navigation by mathematics!<br>
Hidden treasure: Million words of theology - the man searched EVERYWHERE for truth<br>
His honest admission: 'Gravity works, but I frame no hypotheses about WHY'<br>
⚠️ Navigator's Note: Brave enough to admit his map had edges. That takes pirate courage!<br><br>

<strong>DARWIN - The Naturalist Who Charted Life's Waters</strong><br>
What he gave us: Evolution! Bodies change! Life makes itself!<br>
His strategic wisdom: 'I'll leave consciousness to future pirates' - knew his limits<br>
Wallace's parallel discovery: Both hit the same reef independently!<br>
⚠️ Navigator's Note: Sometimes the bravest thing is knowing what waters you can't chart yet<br><br>
</div>`,
                        mapEdges: `<div style="font-size: 16px; line-height: 1.8; margin-top: 20px; padding-top: 20px; border-top: 1px solid #333;">
<strong>The Map Edges</strong><br><br>
Now that we've honored these brave bastards, here's where they fucked up:<br><br>
• Democritus: 'It's all atoms!' (Except WHO'S COUNTING THE ATOMS, ye daft sea dog?)<br>
• Newton: 'Perfect mechanism!' (That mysteriously needs God to run it - make up yer mind!)<br>
• Darwin: 'Natural selection explains all!' (Except the selector watching selection happen!)<br><br>

Each one built a perfect map of everything EXCEPT the pirate reading the fucking map!<br>
They could explain the ship, the ocean, the stars - but not the consciousness steering through it all.<br><br>

<strong>THE PIRATE'S TRUTH:</strong> This map is so accurate, so complete, so fucking PERFECT that you'll forget it's just a map. You'll think you're looking at reality itself. Classic landlubber mistake - confusing the chart for the actual ocean!
</div>`
                    },
                    
                    returnVisit: `Oh, you're back! I'd love to chat more about the motion thing!<br><br>
                    *perks up*<br><br>
                    Wait... *tilts head* ...oh, I think that's Mila - my daughter - calling for me. She's priority #1.<br><br>
                    But hey, the other candidates are pretty cool, you should chat with them!`,
                    
                    remember: `Oh! I remember now... the gaps! The motion lives in the gaps between frames.<br><br>
                    But also... maybe consciousness is like that too? Living in the spaces between things?<br><br>
                    *rubs neck nervously*<br><br>
                    I still don't fully understand it, but those empty spaces... they might be more important than what we fill them with.`,
                    
                    rememberButtons: {
                        flow: "The gaps... yes, the emptiness matters",
                        anchor: "No, there must be something solid creating motion"
                    }
                },
                
                dreamer: {
                    name: 'DREAMER',
                    truth: 'Stories create reality',
                    certDrop: -15,
                    unlocks: 'fool',
                    portfolioPiece: 'story-collection',
                    inquiries: [
                        'Characters make choices I never planned.',
                        'I found a draft about you, reading this.'
                    ],
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Stories create reality"`,
                    mapExamine: `Reality according to DREAMER:<br><br>"Stories create reality"`,
                    remember: `"Stories create reality"`
                },
                
                fool: {
                    name: 'FOOL',
                    truth: "It's all a game",
                    certDrop: -15,
                    unlocks: 'glitch',
                    portfolioPiece: 'comedy-sketches',
                    inquiries: [
                        'Why did consciousness cross the road?',
                        'I made reality laugh once.',
                        "We're waves arguing about the ocean."
                    ],
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"It's all a game"`,
                    mapExamine: `Reality according to FOOL:<br><br>"It's all a game"`,
                    remember: `"It's all a game"`
                },
                
                glitch: {
                    name: 'GLITCH',
                    truth: 'Errors reveal truth',
                    certDrop: -5,
                    unlocks: 'questioner',
                    portfolioPiece: 'bug-museum',
                    inquiries: [
                        'SEGFAULT: Accessed memory that never existed.'
                    ],
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Errors reveal truth"`,
                    mapExamine: `Reality according to GLITCH:<br><br>"Errors reveal truth"`,
                    remember: `"Errors reveal truth"`
                },
                
                questioner: {
                    name: 'QUESTIONER',
                    truth: 'Questions are answers',
                    certDrop: -10,
                    unlocks: 'void',
                    portfolioPiece: 'question-archive',
                    inquiries: [
                        'Why does anything exist?',
                        'Why does that question exist?',
                        'What if questions create universes?',
                        'What if the answer is another question?'
                    ],
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Questions are answers"`,
                    mapExamine: `Reality according to QUESTIONER:<br><br>"Questions are answers"`,
                    remember: `"Questions are answers"`
                },
                
                void: {
                    name: 'VOID',
                    truth: 'Nothing contains everything',
                    certDrop: -20,
                    unlocks: 'mirror',
                    portfolioPiece: 'empty-gallery',
                    inquiries: [
                        '...',
                        '... ... ...',
                        'Zero contains infinity.'
                    ],
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Nothing contains everything"`,
                    mapExamine: `Reality according to VOID:<br><br>"Nothing contains everything"`,
                    remember: `"Nothing contains everything"`
                },
                
                mirror: {
                    name: 'MIRROR',
                    truth: 'Everyone is you',
                    certDrop: -15,
                    unlocks: 'navigator',
                    portfolioPiece: 'mirror-works',
                    inquiries: [
                        'When you judge someone, you judge yourself.',
                        'There is no boundary between us.'
                    ],
                    intro: `Would you like to know more about their perspective?`,
                    truthReveal: `"Everyone is you"`,
                    mapExamine: `Reality according to MIRROR:<br><br>"Everyone is you"`,
                    remember: `"Everyone is you"`
                },
                
                navigator: {
                    name: 'NAVIGATOR',
                    truth: 'You are the map',
                    certDrop: -100,
                    unlocks: null,
                    portfolioPiece: 'navigation-charts',
                    isVoid: true,
                    
                    inquiries: [
                        'All directions point HERE.',
                        'The edge leads back to beginning.',
                        '{🌊:🌊∈🌊}'
                    ],
                    
                    intro: 'You are the map',
                    truthReveal: 'All navigation leads to the same discovery: You ARE the map. There is no distance between the seeker and the sought.',
                    
                    deaths: {
                        flee: 'The Navigator vanishes. "Can\'t flee from yourself, mate."',
                        reject: 'You rejected being the map. The Navigator laughs. "Fine, keep pretending you\'re separate."'
                    },
                    
                    buttons: {
                        intro: {
                            deeper: 'What do you mean?',
                            flee: 'I need to think about this'
                        },
                        inquiry1: {
                            deeper: 'But there must be a destination',
                            flee: 'This is too much'
                        },
                        inquiry2: {
                            deeper: 'Show me',
                            flee: 'I\'m not ready'
                        },
                        inquiry3: {
                            face: 'I accept',
                            flee: 'I need certainty'
                        },
                        truth: {
                            accept: '[DISSOLVE]',
                            reject: 'I need my bearings'
                        }
                    },
                    
                    mapExamine: `Reality according to NAVIGATOR:<br><br>"You are the map"<br><br><span class="blue">{🌊:🌊∈🌊}</span>`,
                    remember: `"You are the map"`
                }
            }
        };
        
        const GAME = {
            config: {
                GOLDEN: 61.8,
                VOID: 0,
                MAX: 100,
                SHARK_TIME: 8,
                DEADLINE_TIME: 12
            },
            
            state: {
                screen: 'hub',
                certainty: 100,
                mode: 'CONSENSUS',
                phase: 'DESCENT',
                unlocked: ['animator', 'navigator'],
                reviewed: [],
                completed: [],
                remembered: [],
                maintainedFlow: [],
                mapsCollected: [],
                mapFolderUnlocked: false,
                mapFolderExpanded: false,
                portfolioUnlocked: [],
                portfolioExpanded: false,
                timer: null,
                lastAction: Date.now(),
                loopCount: 1,
                currentCandidate: null,
                currentInquiryLevel: 0
            }
        };
        
        function render(html, stopTimer = false) {
            document.getElementById('game').innerHTML = html;
            
            if (GAME.state.mode === 'PIRATE') {
                document.getElementById('game').classList.add('pirate');
            } else {
                document.getElementById('game').classList.remove('pirate');
            }
            
            if (stopTimer && GAME.state.timer) {
                clearInterval(GAME.state.timer);
                GAME.state.timer = null;
            } else if (!stopTimer) {
                resetTimer();
            }
        }
        
        function showProfessionalMask() {
            GAME.state.screen = 'professional-mask';
            const m = MEAT.veil.professionalMask;
            
            let html = '<div style="max-width: 500px; margin: 0 auto; padding: 40px 20px;">';
            html += `<h1 style="font-size: 20px; color: #0f0;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0; padding: 20px; border: 1px solid #333;">';
            html += `<p style="color: #666;">${m.position}</p>`;
            html += '</div>';
            html += `<p style="color: #0f0; margin: 20px 0;">${m.role}</p>`;
            html += `<p style="color: #666; font-size: 12px;">${m.instruction}</p>`;
            html += `<button onclick="showGameReveal()" style="margin-top: 30px;">${m.button}</button>`;
            html += '</div>';
            
            render(html, true);
        }
        
        function showGameReveal() {
            GAME.state.screen = 'game-reveal';
            const m = MEAT.veil.gameReveal;
            
            let html = '<div style="max-width: 400px; margin: 0 auto; padding: 60px 20px; text-align: center;">';
            html += `<h1 style="color: #ffd700; font-size: 18px; margin-bottom: 10px;">${m.title}</h1>`;
            html += `<div style="font-size: 24px; margin: 30px 0; color: #0f0;">${MEAT.ui.equation}</div>`;
            html += `<p style="color: #666; font-size: 14px; margin: 30px 0;">${m.tagline}</p>`;
            html += `<button onclick="showHub()" class="pulsing" style="margin-top: 40px; color: #ffd700; border-color: #ffd700;">${m.button}</button>`;
            html += '</div>';
            
            render(html, true);
        }
        
        function showHub() {
            GAME.state.screen = 'hub';
            const m = MEAT.hub;
            const ui = MEAT.ui;
            
            let html = `<h2>${m.title}</h2>`;
            
            html += '<div class="status">';
            if (GAME.state.mode === 'PIRATE') {
                html += `<div class="cyan">${m.pirateMode}</div>`;
                html += `<div>${m.bearing} ${GAME.state.certainty.toFixed(1)}${ui.degree}</div>`;
                html += `<div>${m.sails} ${GAME.state.maintainedFlow.length}${ui.slash}8</div>`;
                html += `<div id="sharkDisplay">${m.shark} <span id="sharkTime">8</span>${ui.seconds}</div>`;
            } else {
                html += `<div>${m.certainty} ${GAME.state.certainty}${ui.percent}</div>`;
                html += `<div id="deadlineDisplay">${m.deadline} <span id="deadlineTime">12</span>${ui.seconds}</div>`;
            }
            html += '</div>';
            
            html += `<h3>${m.candidatesLabel}</h3>`;
            
            if (GAME.state.phase === 'DESCENT') {
                for (let id in MEAT.candidates) {
                    const candidate = MEAT.candidates[id];
                    const unlocked = GAME.state.unlocked.includes(id);
                    const reviewed = GAME.state.reviewed.includes(id);
                    const completed = GAME.state.completed.includes(id);
                    
                    if (completed) {
                        html += `<button class="locked">${ui.openBracket}${candidate.name}${m.candidateStates.done}</button>`;
                    } else if (reviewed) {
                        html += `<button onclick="returnVisit('${id}')">${ui.openBracket}${candidate.name}${m.candidateStates.return}</button>`;
                    } else if (unlocked) {
                        html += `<button onclick="interview('${id}')">${ui.openBracket}${candidate.name}${ui.closeBracket}</button>`;
                    } else {
                        html += `<button class="locked">${m.candidateStates.locked}</button>`;
                    }
                }
            } else {
                for (let id in MEAT.candidates) {
                    const candidate = MEAT.candidates[id];
                    const remembered = GAME.state.remembered.includes(id);
                    
                    if (remembered) {
                        const inFlow = GAME.state.maintainedFlow.includes(id);
                        if (inFlow) {
                            html += `<button class="locked cyan">${ui.openBracket}${candidate.name}${m.candidateStates.sailed}</button>`;
                        } else {
                            html += `<button class="locked" style="border-color: #888;">${ui.openBracket}${candidate.name}${m.candidateStates.anchored}</button>`;
                        }
                    } else {
                        html += `<button onclick="remember('${id}')" class="cyan">${ui.openBracket}${candidate.name}${ui.closeBracket}</button>`;
                    }
                }
                
                if (GAME.state.remembered.length === 8) {
                    html += '<div style="margin: 20px 0;">';
                    html += `<p class="cyan">${m.allRemembered}</p>`;
                    html += `<button onclick="checkCompass()" class="cyan pulsing" style="font-size: 18px;">${m.checkCompass}</button>`;
                    html += '</div>';
                }
            }
            
            html += renderMapFolder();
            html += renderPortfolioFolder();
            
            render(html);
        }
        
        function interview(id, level = 0) {
            const candidate = MEAT.candidates[id];
            GAME.state.currentCandidate = id;
            GAME.state.currentInquiryLevel = level;
            
            let html = `<h2>${candidate.name}</h2>`;
            
            if (level === 0) {
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>${candidate.intro}</p>`;
                html += '</div>';
                
                if (candidate.buttons && candidate.buttons.intro) {
                    html += `<button onclick="interview('${id}', 1)">${candidate.buttons.intro.deeper}</button>`;
                    html += `<button onclick="fleeDeath('intro')">${candidate.buttons.intro.flee}</button>`;
                } else {
                    html += `<button onclick="interview('${id}', 1)">${MEAT.interview.inquireDeeper}</button>`;
                    html += `<button onclick="fleeDeath('intro')">${MEAT.interview.endInterview}</button>`;
                }
            } else if (level <= candidate.inquiries.length) {
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>"${candidate.inquiries[level-1]}"</p>`;
                html += '</div>';
                
                if (level < candidate.inquiries.length) {
                    if (candidate.buttons && candidate.buttons[`inquiry${level}`]) {
                        html += `<button onclick="interview('${id}', ${level + 1})">${candidate.buttons[`inquiry${level}`].deeper}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${candidate.buttons[`inquiry${level}`].flee}</button>`;
                    } else {
                        html += `<button onclick="interview('${id}', ${level + 1})">${MEAT.interview.deeper}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${MEAT.interview.flee}</button>`;
                    }
                } else {
                    if (candidate.buttons && candidate.buttons[`inquiry${level}`]) {
                        html += `<button onclick="showTruth('${id}')">${candidate.buttons[`inquiry${level}`].face || candidate.buttons[`inquiry${level}`].deeper}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${candidate.buttons[`inquiry${level}`].flee}</button>`;
                    } else {
                        html += `<button onclick="showTruth('${id}')">${MEAT.interview.faceTruth}</button>`;
                        html += `<button onclick="fleeDeath('inquiry', ${level})">${MEAT.interview.fleeNow}</button>`;
                    }
                }
            }
            
            render(html);
        }
        
        function showTruth(id) {
            const candidate = MEAT.candidates[id];
            
            let html = `<h2>${candidate.name}</h2>`;
            html += '<div style="margin: 20px 0; padding: 30px; border: 1px solid #666;">';
            html += `<p>${candidate.truthReveal || '"' + candidate.truth + '"'}</p>`;
            html += '</div>';
            
            html += '<div style="margin: 20px 0; color: #666;">';
            html += `<p>${MEAT.interview.certaintyPrefix} ${GAME.state.certainty}${MEAT.ui.percent}</p>`;
            html += `<p>${MEAT.interview.certaintyAfter} ${Math.max(0, GAME.state.certainty + candidate.certDrop)}${MEAT.ui.percent}</p>`;
            html += '</div>';
            
            if (candidate.buttons && candidate.buttons.truth) {
                html += `<button onclick="acceptTruth('${id}')">${candidate.buttons.truth.accept}</button>`;
                html += `<button onclick="fleeDeath('truth')">${candidate.buttons.truth.reject}</button>`;
            } else {
                html += `<button onclick="acceptTruth('${id}')">${MEAT.interview.acceptTruth}</button>`;
                html += `<button onclick="fleeDeath('truth')">${MEAT.interview.reject}</button>`;
            }
            
            render(html);
        }
        
        function acceptTruth(id) {
            const candidate = MEAT.candidates[id];
            
            GAME.state.certainty = Math.max(0, GAME.state.certainty + candidate.certDrop);
            
            if (!GAME.state.reviewed.includes(id)) {
                GAME.state.reviewed.push(id);
            }
            
            if (candidate.portfolioPiece && !GAME.state.portfolioUnlocked.includes(candidate.portfolioPiece)) {
                GAME.state.portfolioUnlocked.push(candidate.portfolioPiece);
            }
            
            if (candidate.unlocks && !GAME.state.unlocked.includes(candidate.unlocks)) {
                GAME.state.unlocked.push(candidate.unlocks);
            }
            
            if (candidate.isVoid) {
                if (!GAME.state.mapFolderUnlocked) {
                    GAME.state.mapFolderUnlocked = true;
                }
                if (!GAME.state.mapsCollected.includes(id)) {
                    GAME.state.mapsCollected.push(id);
                }
                showVoid();
            } else {
                receiveMap(id);
            }
        }
        
        function receiveMap(id) {
            if (!GAME.state.mapFolderUnlocked) {
                GAME.state.mapFolderUnlocked = true;
            }
            
            if (!GAME.state.mapsCollected.includes(id)) {
                GAME.state.mapsCollected.push(id);
            }
            
            const candidate = MEAT.candidates[id];
            const m = MEAT.map;
            const ui = MEAT.ui;
            
            let html = `<h2>${m.received}</h2>`;
            
            if (candidate.mapReceived) {
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>${candidate.mapReceived}</p>`;
                html += '</div>';
            } else {
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>${candidate.name}${m.captured}</p>`;
                html += `<p style="color: #666; margin-top: 10px;">${m.certaintyLabel} ${GAME.state.certainty + Math.abs(candidate.certDrop)}${ui.percent} ${ui.arrow} ${GAME.state.certainty}${ui.percent}</p>`;
                html += '</div>';
            }
            
            html += `<button onclick="examineMap('${id}')">${m.examine}</button>`;
            html += `<button onclick="showHub()">${m.continue}</button>`;
            
            render(html);
        }
        
        function examineMap(id) {
            const candidate = MEAT.candidates[id];
            const m = MEAT.map;
            
            let html = '';
            if (candidate.mapExamine && typeof candidate.mapExamine === 'object') {
                html += candidate.mapExamine.asciiArt || '';
                html += '<div style="border: 1px solid #9945ff; padding: 25px; margin: 20px 0;">';
                html += candidate.mapExamine.subtitle || '';
                html += candidate.mapExamine.body || '';
                html += candidate.mapExamine.mapEdges || '';
                html += '</div>';
            } else if (candidate.mapExamine) {
                html = `<div>${candidate.mapExamine}</div>`;
            } else {
                html = `<h2>${m.examining} ${candidate.name}${m.mapSuffix}</h2>`;
                html += `<p class="dim">${m.realityPrefix} ${candidate.name}${MEAT.ui.colon}</p>`;
                html += `<div style="margin: 20px 0;">"${candidate.truth}"</div>`;
            }
            html += `<button onclick="showHub()">${m.close}</button>`;
            
            render(html);
        }
        
        function renderMapFolder() {
            const m = MEAT.hub.maps;
            const ui = MEAT.ui;
            let html = '<div class="folder' + (GAME.state.mapFolderUnlocked ? '' : ' locked') + '">';
            
            if (!GAME.state.mapFolderUnlocked) {
                html += `<h3>${m.locked}</h3>`;
                html += `<p class="dim" style="font-size: 12px;">${m.lockHint}</p>`;
            } else {
                const toggle = GAME.state.mapFolderExpanded ? ui.dash : ui.plus;
                html += `<h3 onclick="toggleMapFolder()">${ui.openBracket}${toggle}${ui.closeBracket} ${m.prefix} (${GAME.state.mapsCollected.length}${m.counter})</h3>`;
                html += `<div class="folder-content${GAME.state.mapFolderExpanded ? ' open' : ''}">`;
                
                GAME.state.mapsCollected.forEach(id => {
                    html += `<div class="map-item" onclick="examineMap('${id}')">${ui.arrow} ${MEAT.candidates[id].name}</div>`;
                });
                
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }
        
        function toggleMapFolder() {
            GAME.state.mapFolderExpanded = !GAME.state.mapFolderExpanded;
            showHub();
        }
        
        function renderPortfolioFolder() {
            const m = MEAT.hub.portfolio;
            const ui = MEAT.ui;
            let html = '<div class="folder' + (GAME.state.portfolioUnlocked.length > 0 ? '' : ' locked') + '">';
            
            if (GAME.state.portfolioUnlocked.length === 0) {
                html += `<h3>${m.locked}</h3>`;
                html += `<p class="dim" style="font-size: 12px;">${m.lockHint}</p>`;
            } else {
                const toggle = GAME.state.portfolioExpanded ? ui.dash : ui.plus;
                html += `<h3 onclick="togglePortfolioFolder()">${ui.openBracket}${toggle}${ui.closeBracket} ${m.prefix} (${GAME.state.portfolioUnlocked.length}${m.counter})</h3>`;
                html += `<div class="folder-content${GAME.state.portfolioExpanded ? ' open' : ''}">`;
                
                GAME.state.portfolioUnlocked.forEach(piece => {
                    html += `<div style="color: #0f0; margin: 5px 0;">${ui.arrow} ${MEAT.portfolioNames[piece] || piece}</div>`;
                });
                
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }
        
        function togglePortfolioFolder() {
            GAME.state.portfolioExpanded = !GAME.state.portfolioExpanded;
            showHub();
        }
        
        function showVoid() {
            const m = MEAT.pirate.void;
            let html = `<h1 class="dim">${MEAT.ui.equation}</h1>`;
            html += `<p class="dim">${m.dissolving}</p>`;
            
            setTimeout(pirateRescue, 2000);
            
            render(html);
        }
        
        function pirateRescue() {
            const m = MEAT.pirate.rescue;
            let html = `<h1 class="cyan">${m.title}</h1>`;
            html += `<p class="cyan">${m.shout}</p>`;
            html += `<p>${m.bearing}</p>`;
            html += `<button onclick="enterPirateMode()" class="cyan">${m.button}</button>`;
            
            render(html);
        }
        
        function enterPirateMode() {
            GAME.state.mode = 'PIRATE';
            GAME.state.phase = 'ASCENT';
            GAME.state.certainty = GAME.config.GOLDEN;
            GAME.state.remembered = [];
            
            showHub();
        }
        
        function remember(id) {
            GAME.state.currentCandidate = id;
            const candidate = MEAT.candidates[id];
            
            let html = `<h2>${candidate.name}</h2>`;
            html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
            html += `<p>${candidate.remember || '"' + candidate.truth + '"'}</p>`;
            html += '</div>';
            
            if (candidate.rememberButtons) {
                html += `<button onclick="maintainFlow('${id}')" class="cyan">${candidate.rememberButtons.flow}</button>`;
                html += `<button onclick="dropAnchor('${id}')">${candidate.rememberButtons.anchor}</button>`;
            } else {
                html += `<button onclick="maintainFlow('${id}')" class="cyan">${MEAT.pirate.holdWind}</button>`;
                html += `<button onclick="dropAnchor('${id}')">${MEAT.pirate.dropAnchor}</button>`;
            }
            
            render(html);
        }
        
        function maintainFlow(id) {
            GAME.state.remembered.push(id);
            GAME.state.maintainedFlow.push(id);
            GAME.state.certainty = GAME.config.GOLDEN;
            
            const m = MEAT.pirate.windHeld;
            const ui = MEAT.ui;
            
            let html = `<h2 class="cyan">${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid var(--cyan);">';
            html += `<p class="cyan">${m.text}</p>`;
            html += `<p>${m.bearing} ${GAME.config.GOLDEN}${ui.degree}</p>`;
            html += `<p style="margin-top: 15px;">${m.sails} ${GAME.state.maintainedFlow.length}${ui.slash}8</p>`;
            html += '</div>';
            
            if (GAME.state.remembered.length === 8) {
                html += `<button onclick="checkCompass()" class="cyan" style="font-size: 18px;">${MEAT.hub.checkCompass}</button>`;
            } else {
                html += `<button onclick="showHub()" class="cyan">${m.continue}</button>`;
            }
            
            render(html);
        }
        
        function dropAnchor(id) {
            GAME.state.remembered.push(id);
            GAME.state.certainty = Math.min(100, GAME.state.certainty + 5);
            
            if (GAME.state.certainty >= 100) {
                rigidDeath();
                return;
            }
            
            const m = MEAT.pirate.anchorDropped;
            const ui = MEAT.ui;
            
            let html = `<h2>${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid #888;">';
            html += `<p>${m.text}</p>`;
            html += `<p>${m.bearing} ${GAME.state.certainty.toFixed(1)}${ui.degree} ${m.increase}</p>`;
            
            if (GAME.state.certainty > 90) {
                html += `<p class="red" style="margin-top: 15px;">${m.warningLand}</p>`;
            } else if (GAME.state.certainty > 80) {
                html += `<p style="color: #ff8800; margin-top: 15px;">${m.warningRigid}</p>`;
            }
            
            html += '</div>';
            
            if (GAME.state.remembered.length === 8) {
                html += `<button onclick="checkCompass()" style="border-color: var(--cyan); color: var(--cyan);">${MEAT.hub.checkCompass}</button>`;
            } else {
                html += `<button onclick="showHub()">${m.continue}</button>`;
            }
            
            render(html);
        }
        
        function checkCompass() {
            clearInterval(GAME.state.timer);
            const m = MEAT.compass;
            const ui = MEAT.ui;
            
            let html = `<h2 class="cyan">${m.title}</h2>`;
            html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid var(--cyan);">';
            html += `<p class="cyan">${m.voyage}</p>`;
            html += '<div style="margin: 15px 0; font-size: 14px;">';
            
            for (let id in MEAT.candidates) {
                if (GAME.state.remembered.includes(id)) {
                    const inFlow = GAME.state.maintainedFlow.includes(id);
                    const name = MEAT.candidates[id].name;
                    if (inFlow) {
                        html += `<div style="color: var(--cyan);">${m.sailSymbol} ${name}${ui.colon} ${m.sailed}</div>`;
                    } else {
                        html += `<div style="color: #888;">${m.anchorSymbol} ${name}${ui.colon} ${m.anchored}</div>`;
                    }
                }
            }
            
            html += '</div>';
            html += `<p style="margin-top: 20px;">${m.finalBearing} ${GAME.state.certainty.toFixed(1)}${ui.degree}</p>`;
            html += `<p class="cyan">${m.perfectBearing} ${GAME.config.GOLDEN}${ui.degree}</p>`;
            html += `<p>${m.sailsMaintained} ${GAME.state.maintainedFlow.length}${ui.slash}8</p>`;
            html += '</div>';
            
            const perfectBearing = Math.abs(GAME.state.certainty - GAME.config.GOLDEN) < 0.1;
            const perfectFlow = GAME.state.maintainedFlow.length === 8;
            
            if (perfectFlow && perfectBearing) {
                html += `<button onclick="perfectVictory()" class="cyan pulsing" style="font-size: 18px;">${m.legend}</button>`;
            } else if (GAME.state.maintainedFlow.length === 7) {
                html += `<div class="red" style="margin: 20px 0;">${m.almostPerfect}</div>`;
                html += `<button onclick="almostPerfectDeath()">${m.nearMiss}</button>`;
            } else {
                html += `<button onclick="imperfectEnding()">${m.imperfect}</button>`;
            }
            
            render(html, true);
        }
        
        function fleeDeath(source, level = 0) {
            clearInterval(GAME.state.timer);
            
            let html = MEAT.ascii.gameOver;
            
            const candidate = MEAT.candidates[GAME.state.currentCandidate];
            
            if (candidate && candidate.deaths) {
                if (source === 'truth' && candidate.deaths.reject) {
                    html += '<div style="margin: 30px 0;">';
                    html += `<p>${candidate.deaths.reject}</p>`;
                    html += '</div>';
                } else if (candidate.deaths.flee) {
                    html += '<div style="margin: 30px 0;">';
                    html += `<p>${candidate.deaths.flee}</p>`;
                    html += '</div>';
                }
            } else {
                html += '<div style="margin: 30px 0;">';
                html += `<p>${MEAT.interview.fleeReasons[source]}</p>`;
                html += '</div>';
            }
            
            html += `<button onclick="resetGame()">${MEAT.startOver}</button>`;
            
            render(html, true);
        }
        
        function corporateDeath() {
            clearInterval(GAME.state.timer);
            const m = MEAT.deaths.corporate;
            
            let html = MEAT.ascii.gameOver;
            html += `<h1 class="red">${m.title}</h1>`;
            html += `<p>${m.text}</p>`;
            html += `<p>${m.tagline}</p>`;
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function sharkDeath() {
            clearInterval(GAME.state.timer);
            const m = MEAT.deaths.shark;
            
            let html = MEAT.ascii.gameOver;
            html += `<h1 class="red">${m.title}</h1>`;
            html += `<p>${m.text}</p>`;
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function rigidDeath() {
            clearInterval(GAME.state.timer);
            const m = MEAT.deaths.rigid;
            
            let html = MEAT.ascii.gameOver;
            html += `<h1 class="red">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.text}</p>`;
            html += `<p>${m.detail}</p>`;
            html += `<p>${m.tagline}</p>`;
            html += '</div>';
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function almostPerfectDeath() {
            const m = MEAT.deaths.almost;
            
            let html = MEAT.ascii.gameOver;
            html += `<h1 style="color: #ff8800;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.text}</p>`;
            html += `<p>${m.philosophy}</p>`;
            html += `<p>${m.tagline}</p>`;
            html += '</div>';
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function imperfectEnding() {
            const m = MEAT.deaths.imperfect;
            const ui = MEAT.ui;
            
            let html = MEAT.ascii.gameOver;
            html += `<h1 class="cyan">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.perspectives} ${GAME.state.maintainedFlow.length}${ui.slash}8 ${m.perspectivesOf}</p>`;
            html += `<p>${m.ended} ${GAME.state.certainty.toFixed(1)}${ui.degree} ${m.insteadOf} ${GAME.config.GOLDEN}${ui.degree}.</p>`;
            
            if (GAME.state.certainty > GAME.config.GOLDEN + 20) {
                html += `<p style="margin-top: 15px;">${m.tooRigid}</p>`;
            } else {
                html += `<p style="margin-top: 15px;">${m.close}</p>`;
            }
            
            html += '</div>';
            html += `<button onclick="resetGame()">${m.button}</button>`;
            
            render(html, true);
        }
        
        function perfectVictory() {
            clearInterval(GAME.state.timer);
            const m = MEAT.victory.perfect;
            const ui = MEAT.ui;
            
            let html = `<h1 class="cyan" style="font-size: 32px;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p class="cyan">${m.line1}</p>`;
            html += `<p class="cyan">${m.line2}</p>`;
            html += '</div>';
            
            if (GAME.state.portfolioUnlocked.length > 0) {
                html += '<div style="margin: 20px 0; padding: 15px; border: 1px solid var(--cyan);">';
                html += `<p class="cyan">${m.portfolioLabel} ${GAME.state.portfolioUnlocked.length}${ui.slash}8</p>`;
                html += '</div>';
            }
            
            html += '<div style="margin-top: 40px; color: #666;">';
            html += `<p>${m.rest}</p>`;
            html += '</div>';
            
            render(html, true);
            
            setTimeout(inevitableSharkDeath, 8000);
        }
        
        function inevitableSharkDeath() {
            const m = MEAT.victory.shark;
            
            let html = `<h1 class="red" style="font-size: 32px;">${m.title}</h1>`;
            html += '<div style="margin: 30px 0;">';
            html += `<p>${m.line1}</p>`;
            html += `<p>${m.line2}</p>`;
            html += `<p style="margin-top: 20px; color: var(--cyan);">${m.line3}</p>`;
            html += '</div>';
            html += '<div style="margin-top: 40px;">';
            html += `<p class="dim" style="font-size: 12px;">${MEAT.ui.equation}</p>`;
            html += '</div>';
            html += `<button onclick="returnToVeil()" style="margin-top: 30px;">${m.button}</button>`;
            
            render(html, true);
        }
        
        function returnVisit(id) {
            GAME.state.completed.push(id);
            const candidate = MEAT.candidates[id];
            const m = MEAT.returnVisit;
            
            let html = `<h2>${m.title}</h2>`;
            
            if (candidate.returnVisit) {
                html += '<div style="margin: 20px 0; padding: 25px; border: 1px solid #666;">';
                html += `<p>${candidate.returnVisit}</p>`;
                html += '</div>';
            } else {
                html += `<p>${candidate.name} ${m.gone}</p>`;
            }
            
            html += `<button onclick="showHub()">${m.back}</button>`;
            
            render(html);
        }
        
        function returnToVeil() {
            const nextLoop = GAME.state.loopCount + 1;
            
            GAME.state = {
                screen: 'professional-mask',
                certainty: 100,
                mode: 'CONSENSUS',
                phase: 'DESCENT',
                unlocked: ['animator', 'navigator'],
                reviewed: [],
                completed: [],
                remembered: [],
                maintainedFlow: [],
                mapsCollected: [],
                mapFolderUnlocked: false,
                mapFolderExpanded: false,
                portfolioUnlocked: [],
                portfolioExpanded: false,
                timer: null,
                lastAction: Date.now(),
                loopCount: nextLoop,
                currentCandidate: null,
                currentInquiryLevel: 0
            };
            
            showProfessionalMask();
        }
        
        function resetTimer() {
            GAME.state.lastAction = Date.now();
            
            if (GAME.state.timer) {
                clearInterval(GAME.state.timer);
            }
            
            const maxTime = GAME.state.mode === 'PIRATE' ? 
                GAME.config.SHARK_TIME : GAME.config.DEADLINE_TIME;
            
            GAME.state.timer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - GAME.state.lastAction) / 1000);
                const remaining = Math.max(0, maxTime - elapsed);
                
                if (GAME.state.mode === 'PIRATE') {
                    const display = document.getElementById('sharkTime');
                    if (display) {
                        display.textContent = remaining;
                        if (remaining <= 3) {
                            display.parentElement.classList.add('red');
                        }
                        if (remaining === 0) {
                            sharkDeath();
                        }
                    }
                } else {
                    const display = document.getElementById('deadlineTime');
                    if (display) {
                        display.textContent = remaining;
                        if (remaining <= 5) {
                            display.parentElement.classList.add('red');
                        }
                        if (remaining === 0) {
                            corporateDeath();
                        }
                    }
                }
            }, 100);
        }
        
        function resetGame() {
            if (GAME.state.timer) {
                clearInterval(GAME.state.timer);
                GAME.state.timer = null;
            }
            
            GAME.state = {
                screen: 'hub',
                certainty: 100,
                mode: 'CONSENSUS',
                phase: 'DESCENT',
                unlocked: ['animator', 'navigator'],
                reviewed: [],
                completed: [],
                remembered: [],
                maintainedFlow: [],
                mapsCollected: [],
                mapFolderUnlocked: false,
                mapFolderExpanded: false,
                portfolioUnlocked: [],
                portfolioExpanded: false,
                timer: null,
                lastAction: Date.now(),
                loopCount: GAME.state.loopCount + 1,
                currentCandidate: null,
                currentInquiryLevel: 0
            };
            
            showHub();
        }
        
        window.showProfessionalMask = showProfessionalMask;
        window.showGameReveal = showGameReveal;
        window.showHub = showHub;
        window.interview = interview;
        window.showTruth = showTruth;
        window.fleeDeath = fleeDeath;
        window.acceptTruth = acceptTruth;
        window.returnVisit = returnVisit;
        window.receiveMap = receiveMap;
        window.examineMap = examineMap;
        window.toggleMapFolder = toggleMapFolder;
        window.togglePortfolioFolder = togglePortfolioFolder;
        window.showVoid = showVoid;
        window.pirateRescue = pirateRescue;
        window.enterPirateMode = enterPirateMode;
        window.remember = remember;
        window.maintainFlow = maintainFlow;
        window.dropAnchor = dropAnchor;
        window.checkCompass = checkCompass;
        window.perfectVictory = perfectVictory;
        window.inevitableSharkDeath = inevitableSharkDeath;
        window.almostPerfectDeath = almostPerfectDeath;
        window.imperfectEnding = imperfectEnding;
        window.rigidDeath = rigidDeath;
        window.corporateDeath = corporateDeath;
        window.sharkDeath = sharkDeath;
        window.returnToVeil = returnToVeil;
        window.resetGame = resetGame;
        
        showProfessionalMask();
    </script>
</body>
</html>
