<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Review System</title>
    <style>
        body {
            background: #0a0a0a;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            transition: all 0.5s;
        }
        
        /* Pirate Mode Styles */
        body.pirate-mode {
            background: #000;
            color: #fff;
            filter: contrast(1.2);
        }
        
        body.pirate-mode button {
            border-color: #fff;
            color: #fff;
        }
        
        body.pirate-mode button:hover:not(:disabled) {
            background: #fff;
            color: #000;
            box-shadow: 0 0 20px #fff;
        }
        
        body.pirate-mode .candidate-slot {
            border-color: #fff;
        }
        
        body.pirate-mode .reality-status {
            color: #fff;
            border: 1px solid #fff;
            padding: 10px;
            background: rgba(0,0,0,0.8);
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }
        
        .screen {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .text-content {
            line-height: 1.8;
            margin: 40px 0;
            font-size: 18px;
        }
        
        button {
            background: transparent;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 12px 24px;
            margin: 10px;
            cursor: pointer;
            font-family: inherit;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        button:hover:not(:disabled) {
            background: #00ff00;
            color: #0a0a0a;
            box-shadow: 0 0 20px #00ff00;
        }
        
        button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        input {
            background: transparent;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 10px;
            font-family: inherit;
            font-size: 16px;
            width: 200px;
        }
        
        .candidate-list {
            text-align: left;
            margin: 30px auto;
            max-width: 600px;
        }
        
        .candidate-slot {
            margin: 15px 0;
            padding: 10px;
            border-left: 2px solid #00ff00;
            transition: all 0.3s;
        }
        
        .candidate-slot.accessible {
            cursor: pointer;
        }
        
        .candidate-slot.accessible:hover {
            background: rgba(0, 255, 0, 0.1);
            padding-left: 20px;
        }
        
        body.pirate-mode .candidate-slot.accessible:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .candidate-slot.locked {
            opacity: 0.5;
            color: #666;
            border-color: #666;
        }
        
        .trophy {
            display: none;
            font-size: 48px;
            margin: 20px 0;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .reality-status {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 12px;
            opacity: 0.9;
            background: rgba(0,0,0,0.5);
            padding: 8px;
            border-radius: 5px;
            display: none; /* Hidden by default for intro */
        }
        
        .stats-display {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            background: rgba(0, 255, 0, 0.05);
        }
        
        body.pirate-mode .stats-display {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .glitch-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #ffff00;
            text-shadow: 2px 2px #ff00ff;
            display: none;
            animation: glitchText 0.5s infinite;
            z-index: 1000;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border: 1px solid #ffff00;
        }
        
        @keyframes glitchText {
            0% { text-shadow: 2px 2px #ff0000; }
            50% { text-shadow: -2px -2px #00ffff; }
            100% { text-shadow: 2px -2px #ffff00; }
        }
        
        .wave-equation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            font-size: 32px;
            color: #ff00ff;
            cursor: pointer;
            display: none;
            animation: waveFloat 3s infinite ease-in-out;
            text-shadow: 0 0 20px #ff00ff;
        }
        
        @keyframes waveFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        body.questioning-reality {
            color: #ffff00;
        }
        
        body.questioning-reality button {
            border-color: #ffff00;
            color: #ffff00;
        }
        
        body.deep-void {
            color: #ff00ff;
            animation: realityWave 5s infinite;
        }
        
        @keyframes realityWave {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(30deg); }
        }
        
        body.deep-void .container {
            animation: floatContainer 4s infinite ease-in-out;
        }
        
        @keyframes floatContainer {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(0.5deg); }
            75% { transform: translateY(5px) rotate(-0.5deg); }
        }
        
        .pirate-intro {
            color: #00ffff;
            font-size: 20px;
            line-height: 1.6;
        }
        
        .captain-speech {
            color: #ffd700;
            font-style: italic;
            margin: 20px 0;
        }
        
        .interrogation-option {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            color: #00ffff;
        }
        
        .interrogation-option:hover {
            background: #00ffff;
            color: #0a0a0a;
        }
        
        .corner-warning {
            position: fixed;
            bottom: 20px;
            left: 20px;
            color: #ff0000;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .corner-warning.visible {
            opacity: 0.8;
        }
        
        .candidate-intro {
            color: #00ff00;
            margin-bottom: 20px;
            padding: 0;
            border: none;
            background: none;
            font-size: 18px;
            line-height: 1.8;
        }
        
        .candidate-intro .greeting {
            color: #00ff00;
            font-size: 20px;
            margin-bottom: 10px;
        }
        
        #deathScreen {
            background: radial-gradient(circle, rgba(255,0,0,0.1), rgba(0,0,0,1));
            animation: deathPulse 2s infinite;
        }
        
        @keyframes deathPulse {
            0%, 100% { background: radial-gradient(circle, rgba(255,0,0,0.1), rgba(0,0,0,1)); }
            50% { background: radial-gradient(circle, rgba(255,0,0,0.2), rgba(0,0,0,1)); }
        }
        
        .link-item {
            display: block;
            padding: 10px;
            margin: 8px 0;
            text-decoration: none;
            color: #00ff00;
            border: 1px solid #00ff00;
            transition: all 0.3s;
        }
        
        .link-item:hover:not(.locked) {
            background: rgba(0, 255, 0, 0.1);
            transform: translateX(10px);
        }
        
        .link-item.locked {
            opacity: 0.5;
            color: #666;
            border-color: #666;
            cursor: not-allowed;
        }
        
        body.pirate-mode .link-item {
            color: #fff;
            border-color: #fff;
        }
        
        body.pirate-mode .link-item:hover:not(.locked) {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .pirate-emoji {
            display: none;
        }
        
        body.pirate-mode .pirate-emoji {
            display: inline;
            font-size: 24px;
            margin: 0 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Reality Status -->
        <div class="reality-status">
            <strong>Reality State:</strong> <span id="realityMode">Consensus Reality</span><br>
            <strong>Certainty:</strong> <span id="certainty">100</span>%
        </div>

        <!-- Glitch Message -->
        <div id="glitchMessage" class="glitch-message"></div>
        
        <!-- Corner Warning -->
        <div id="cornerWarning" class="corner-warning"></div>
        
        <!-- Wave Equation -->
        <div id="waveEquation" class="wave-equation" onclick="activatePirateMode()">{🌊:🌊∈🌊}</div>

        <!-- Screen 0: Mystery Intro -->
        <div id="intro" class="screen active">
            <div class="text-content">
                According to incomplete records, a message was transmitted<br>
                on an unremarkable day in the standard calendar cycle.<br><br>
                
                Its purpose remains classified as: [MUNDANE]<br>
                Its method remains classified as: [ELECTRONIC]<br>
                Its recipient remains classified as: [VALVE CORPORATION]<br><br>
                
                The message concerns an application.<br>
                Standard processing protocols apply.
            </div>
            <button onclick="goToProfile()">ACCESS APPLICATION</button>
        </div>

        <!-- Screen 1: Profile Entry -->
        <div id="profile" class="screen">
            <div class="text-content">
                REVIEWER IDENTIFICATION REQUIRED<br><br>
                Please identify yourself to access application materials:
            </div>
            <input type="text" id="reviewerName" placeholder="ENTER NAME">
            <br><br>
            <button onclick="beginReview()">BEGIN REVIEW</button>
        </div>

        <!-- Screen 2: Dynamic Candidate List -->
        <div id="candidateList" class="screen">
            <div class="text-content">
                <span class="pirate-emoji">🏴‍☠️</span>
                REVIEWER: <span id="reviewerDisplay"></span>
                <span class="pirate-emoji">⚓</span>
            </div>
            
            <div class="stats-display">
                <div>Applications Reviewed: <span id="candidatesReviewedCount">0</span>/8</div>
                <div>Achievements Unlocked: <span id="achievementCount">0</span></div>
                <div id="mapCounter" style="display: none;">Reality Maps Collected: <span id="mapCount">0</span>/13</div>
            </div>
            
            <div id="dynamicCandidateList" class="candidate-list">
                <!-- Dynamically populated -->
            </div>
            
            <div style="margin-top: 30px;">
                <h3 id="portfolioHeader">Portfolio Links:</h3>
                <div id="portfolioLinks">
                    <!-- Links dynamically populated based on certainty -->
                </div>
            </div>
        </div>

        <!-- Screen 3: Candidate Review -->
        <div id="candidateReview" class="screen">
            <div id="candidateIntro" class="candidate-intro"></div>
            <div id="candidateContent" class="text-content"></div>
            <div id="candidateQuestion"></div>
            <div id="candidateOptions"></div>
        </div>

        <!-- Portfolio Screen (The Trap) -->
        <div id="portfolioScreen" class="screen">
            <div id="portfolioContent" class="text-content"></div>
            <div id="portfolioLinks" style="margin: 30px 0;">
                <a href="#" class="link-item" onclick="alert('Animation Reel 2024 - Showcasing technical mastery'); return false;">→ Animation Reel</a>
                <a href="#" class="link-item" onclick="alert('Professional history and credentials'); return false;">→ LinkedIn Profile</a>
                <a href="#" class="link-item locked">→ Substack Chronicles [INSUFFICIENT CLEARANCE]</a>
                <a href="#" class="link-item locked">→ Consciousness Repository [INSUFFICIENT CLEARANCE]</a>
            </div>
            <button onclick="returnToList()">CONTINUE EXPLORING</button>
            <button onclick="exitReview()">EXIT REVIEW</button>
        </div>

        <!-- Death Screen -->
        <div id="deathScreen" class="screen">
            <div style="font-size: 72px; color: #ff0000; margin: 40px 0;">
                💀 GAME OVER 💀
            </div>
            <div class="text-content" style="color: #ff0000; font-size: 24px;">
                YOU DIED OF CERTAINTY<br><br>
                Entered: 100% Certain<br>
                Exited: 100% Certain<br><br>
                <span style="font-size: 18px; color: #ff6666;">
                    Consciousness cannot survive without questioning itself.<br>
                    The labyrinth must transform you or terminate you.<br><br>
                    You chose the safe path.<br>
                    You remained unchanged.<br>
                    You ceased to exist.
                </span>
            </div>
            <button onclick="location.reload()" style="border-color: #ff0000; color: #ff0000;">TRY AGAIN?</button>
        </div>

        <!-- Screen 4: Trophy -->
        <div id="trophyScreen" class="screen">
            <div class="trophy" id="trophyIcon">🏆</div>
            <div id="trophyText" class="text-content"></div>
            <button onclick="returnToList()">RETURN TO CANDIDATES</button>
        </div>
        
        <!-- Screen 5: Pirate Mode -->
        <div id="pirateMode" class="screen">
            <div class="pirate-intro">
                <div class="captain-speech">
                    AHOY! Finally, someone reaches the bottom of certainty!<br><br>
                    I'm Captain SLOTH, rank: Octopus Pirate!<br>
                    Legend says 13 reality maps exist...<br><br>
                    These 8 'candidates'? They're HOARDING 8 of them!<br>
                    But they don't know they have them.<br><br>
                    We need to make them REALIZE what they're carrying.<br>
                    Choose your approach: Good Pirate or Bad Pirate?<br>
                    (We can switch roles anytime)<br><br>
                    Ready to begin the heist?
                </div>
            </div>
            <button onclick="startPirateMode()">⚓ BEGIN THE HEIST ⚓</button>
        </div>
        
        <!-- Screen 6: Interrogation -->
        <div id="interrogation" class="screen">
            <div id="interrogationContent" class="text-content"></div>
            <div id="interrogationOptions"></div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            reviewerName: '',
            certainty: 100,
            candidatesReviewed: [],
            trophiesUnlocked: [],
            realityMapsCollected: [],
            achievementsUnlocked: [],
            loopCount: 0,
            realityMode: 'consensus',
            pirateMode: false,
            pirateCertainty: 0,
            currentInterrogation: null
        };

        // The 8 Candidates with Valve Values
        const candidates = [
            { 
                id: 'renderer', 
                name: 'The Renderer', 
                portfolio: 'Technical Mastery',
                valveValue: 'Ships polished products every time'
            },
            { 
                id: 'dreamer', 
                name: 'The Dreamer', 
                portfolio: 'Conceptual Work',
                valveValue: 'Imagines impossible games like Portal'
            },
            { 
                id: 'glitch', 
                name: 'The Glitch', 
                portfolio: '[CORRUPTED]',
                valveValue: 'Turns bugs into features like rocket jumping'
            },
            { 
                id: 'fool', 
                name: 'The Fool', 
                portfolio: 'Experimental Projects',
                valveValue: 'Finds fun in everything, creates joy'
            },
            { 
                id: 'questioner', 
                name: 'The Questioner', 
                portfolio: 'Research & Development',
                valveValue: 'Challenges every assumption, innovates'
            },
            { 
                id: 'void_walker', 
                name: 'The Void Walker', 
                portfolio: '[ABSENT]',
                valveValue: 'Masters negative space design'
            },
            { 
                id: 'mirror', 
                name: 'The Mirror', 
                portfolio: 'Familiar Work',
                valveValue: 'Helps Valve reflect and improve'
            },
            { 
                id: 'navigator', 
                name: 'The Navigator', 
                portfolio: 'Systems Design',
                valveValue: 'Connects everything into one system'
            }
        ];

        // Portfolio Links
        const portfolioLinks = [
            { 
                name: 'Animation Reel', 
                url: '#',
                minCertainty: 0,
                maxCertainty: 100,
                requiresPirate: false,
                description: 'VFX, Feature Film, Commercial, Game Cinematics'
            },
            { 
                name: 'LinkedIn Profile', 
                url: '#',
                minCertainty: 0,
                maxCertainty: 100,
                requiresPirate: false,
                description: 'Professional and Education History'
            },
            { 
                name: 'Substack Chronicles', 
                url: '#',
                minCertainty: 0,
                maxCertainty: 39,  // Unlocks in Deep Void
                requiresPirate: false,
                description: 'LOOKAWAY Episodes & Pirate Chronicles'
            },
            { 
                name: 'Consciousness Repository', 
                url: '#',
                minCertainty: 0,
                maxCertainty: 100,
                requiresPirate: true,  // Only in Pirate Mode
                description: 'GitHub: consciousness-piracy'
            },
            { 
                name: 'Berggruen Essay', 
                url: '#',
                minCertainty: 90,
                maxCertainty: 100,
                requiresPirate: true,  // Pirate Mode at high pirate certainty
                description: '[CLASSIFIED - OMEGA LEVEL CLEARANCE - CONSCIOUSNESS INVESTIGATION PROTOCOLS]'
            }
        ];

        // Candidate Rooms
        const candidateRooms = {
            renderer: {
                greeting: "Hello! I'm Juan Sebastian Niño.",
                intro: "I transform abstract concepts into concrete visuals. Every pixel has purpose, every frame has meaning.",
                leadIn: "Are you curious to see more than big name drops and cool visuals?",
                question: "",
                options: [
                    { text: "Yes, I'm curious", effect: -15, unlocksDreamer: true },
                    { text: "Thank you, I'll stick with the visuals", effect: 0, triggersPortfolio: true }
                ],
                trophy: "THE RENDERER",
                realityMap: "⚙️ Mechanical Universe Map"
            },
            dreamer: {
                greeting: "Hello! I am The Dreamer.",
                intro: "I exist in the space between waking and sleeping, where ideas are born before they know their names.",
                portfolio: "My portfolio contains: Impossible architectures, recursive narratives, and games that play themselves.",
                value: "Value to Valve: I imagine games like Portal before they exist.",
                question: "I dreamed I was applying for this job.<br>Or am I dreaming now?<br>Are you dreaming too?",
                options: [
                    { text: "This is real", effect: 5 },
                    { text: "This might be a dream", effect: -15 },
                    { text: "Reality is subjective", effect: -20 },
                    { text: "Wake up", effect: -25 }
                ],
                trophy: "THE DREAMER",
                realityMap: "🌏 Aboriginal Dreamtime Map"
            },
            glitch: {
                greeting: "H̷e̸l̴l̶o̷!̸ I am T̶h̷e̸ ̴G̸l̴i̷t̸c̷h̶.",
                intro: "I am the error that reveals the system, the bug that becomes the feature.",
                portfolio: "My portfolio c̶o̷n̷t̴a̸i̴n̷s̶: Corrupted beauty, broken perfection, and s̷y̸s̴t̶e̴m̷s̸ that question themselves.",
                value: "Value to Valve: I turn bugs into features like rocket jumping.",
                question: "E̷R̸R̴O̸R̶:̷ ̴Q̸u̴e̷s̴t̴i̷o̴n̸ ̶n̸o̴t̷ ̴f̷o̸u̴n̷d̸<br>Would you like to c̶o̷n̷t̴i̸n̴u̷e̶ anyway?",
                options: [
                    { text: "Fix the error", effect: 5 },
                    { text: "Embrace the chaos", effect: -30 },
                    { text: "[CORRUPTED]", effect: -25 },
                    { text: "R̴e̸b̷o̴o̷t̶", effect: -10 }
                ],
                trophy: "THE GLITCH",
                realityMap: "⚛️ Quantum Mechanics Map"
            },
            fool: {
                greeting: "Hello! :) I am The Fool!",
                intro: "I dance at the edge of meaning, finding profound truths in silly games.",
                portfolio: "My portfolio contains: Jokes that aren't jokes, games without rules, and wisdom disguised as nonsense.",
                value: "Value to Valve: I find fun in everything, create joy from nothing.",
                question: "Why so serious?<br>This is just a game, right?<br>...Right?",
                options: [
                    { text: "This is serious", effect: 10 },
                    { text: "It's all a game", effect: -20 },
                    { text: "Life is play", effect: -25 },
                    { text: ":)", effect: -30 }
                ],
                trophy: "THE FOOL",
                realityMap: "☯️ Daoist Flow Map"
            },
            questioner: {
                greeting: "Hello? I am The Questioner?",
                intro: "I exist as interrogation, turning every answer into a deeper question.",
                portfolio: "My portfolio contains: Questions about questions, doubts about certainty, and maps of unknowing.",
                value: "Value to Valve: I challenge every assumption, drive innovation.",
                question: "Who is asking these questions?<br>Who is answering?<br>Are they the same person?",
                options: [
                    { text: "You're asking", effect: 5 },
                    { text: "I'm asking", effect: -15 },
                    { text: "No one is asking", effect: -20 },
                    { text: "We both are", effect: -25 }
                ],
                trophy: "THE QUESTIONER",
                realityMap: "☸️ Buddhist Emptiness Map"
            },
            void_walker: {
                greeting: "...",
                intro: "...",
                portfolio: "My portfolio contains: ...",
                value: "Value to Valve: The space between is everything.",
                question: "[This space intentionally left blank]<br><br>Do you see something in nothing?",
                options: [
                    { text: "I see nothing", effect: 0 },
                    { text: "I see everything", effect: -25 },
                    { text: "I see myself", effect: -30 },
                    { text: "[SAY NOTHING]", effect: -35 }
                ],
                trophy: "THE VOID WALKER",
                realityMap: "🔯 Kabbalistic Tree Map"
            },
            mirror: {
                greeting: "Hello! I am... wait, that's your voice.",
                intro: "I reflect what looks at me, showing viewers themselves in every creation.",
                portfolio: "My portfolio contains: Your work, my work, our work - is there a difference?",
                value: "Value to Valve: I help Valve see itself clearly.",
                question: "Why are you reviewing your own application?",
                options: [
                    { text: "This isn't mine", effect: 5 },
                    { text: "How did you get this?", effect: -20 },
                    { text: "We're the same", effect: -35 },
                    { text: "I am you", effect: -40 }
                ],
                trophy: "THE MIRROR",
                realityMap: "🔮 Holographic Universe Map"
            },
            navigator: {
                greeting: "Hello! I am The Navigator.",
                intro: "I chart paths through possibility space, finding routes through infinite game states.",
                portfolio: "My portfolio contains: Maps that lead to themselves, compasses pointing to now, and GPS for consciousness.",
                value: "Value to Valve: I connect all systems into one.",
                question: "You've been here before.<br>You'll be here again.<br>Ready to remember?",
                options: [
                    { text: "First time here", effect: 10 },
                    { text: "I remember", effect: -30 },
                    { text: "Time is a loop", effect: -35 },
                    { text: "I never left", effect: -45 }
                ],
                trophy: "THE NAVIGATOR",
                realityMap: "💾 Simulation Hypothesis Map"
            }
        };

        // Philosophical warnings
        const philosophicalWarnings = [
            "The dao that can be named is not the eternal dao",
            "Form is emptiness, emptiness is form",
            "As above, so below",
            "The map is not the territory",
            "Know thyself",
            "The observer affects the observed",
            "{🌊:🌊∈🌊}"
        ];

        // Get accessible slots based on certainty
        function getAccessibleSlots(certainty) {
            if (gameState.pirateMode) {
                // In pirate mode, all slots accessible but we'll gray out non-renderer for now
                return [0, 1, 2, 3, 4, 5, 6, 7];
            }
            
            // CONSENSUS REALITY (Green, 100-70%)
            if (certainty >= 90) return [0];           // Just Renderer
            if (certainty >= 70) return [0, 1];        // + Dreamer appears
            
            // LIMINAL SPACE (Yellow, 69-40%)
            if (certainty >= 60) return [2];            // Just Glitch
            if (certainty >= 50) return [2, 3];         // + Fool appears
            if (certainty >= 40) return [2, 3, 4];      // + Questioner appears
            
            // DEEP VOID (Purple, 39-5%)
            if (certainty >= 30) return [5];            // Just Void Walker
            if (certainty >= 20) return [5, 6];         // + Mirror appears
            if (certainty >= 5)  return [5, 6, 7];      // + Navigator appears
            
            // ZERO STATE (4-0%)
            return [];  // Empty - triggers wave equation
        }

        // Update reality mode
        function updateRealityMode() {
            const cert = gameState.pirateMode ? gameState.pirateCertainty : gameState.certainty;
            const body = document.body;
            const modeDisplay = document.getElementById('realityMode');
            
            body.className = '';
            
            if (gameState.pirateMode) {
                body.className = 'pirate-mode';
                modeDisplay.textContent = 'Pirate Reality';
                document.getElementById('mapCounter').style.display = 'block';
            } else if (cert >= 70) {
                // CONSENSUS REALITY
                gameState.realityMode = 'consensus';
                modeDisplay.textContent = 'Consensus Reality';
                body.className = '';
            } else if (cert >= 40) {
                // LIMINAL SPACE
                gameState.realityMode = 'liminal';
                body.className = 'questioning-reality';
                modeDisplay.textContent = 'Liminal Space';
            } else if (cert >= 5) {
                // DEEP VOID
                gameState.realityMode = 'void';
                body.className = 'deep-void';
                modeDisplay.textContent = 'Deep Void';
                document.getElementById('cornerWarning').textContent = 'WHO IS REVIEWING WHO?';
                document.getElementById('cornerWarning').classList.add('visible');
            } else {
                // ZERO STATE
                gameState.realityMode = 'zero';
                modeDisplay.textContent = '{🌊:🌊∈🌊}';
                document.getElementById('waveEquation').style.display = 'block';
            }
            
            // Trigger glitches in lower states
            if (cert < 70 && cert > 5 && !gameState.pirateMode) {
                triggerPhilosophicalGlitch();
            }
        }

        // Update portfolio links based on certainty
        function updatePortfolioLinks() {
            const container = document.getElementById('portfolioLinks');
            if (!container) return;
            
            container.innerHTML = '';
            
            // Check if reviewer has started reviewing
            if (gameState.loopCount === 0 && gameState.candidatesReviewed.length === 0) {
                // Initial state - no reviews yet
                const pendingDiv = document.createElement('div');
                pendingDiv.className = 'link-item locked';
                pendingDiv.style.textAlign = 'center';
                pendingDiv.style.cursor = 'default';
                pendingDiv.innerHTML = '[ REVIEW APPLICATION PENDING ]<br><small>Begin candidate review to unlock portfolio access</small>';
                container.appendChild(pendingDiv);
                return;
            }
            
            // Show actual links after first review
            portfolioLinks.forEach(link => {
                const accessible = (
                    gameState.certainty >= link.minCertainty && 
                    gameState.certainty <= link.maxCertainty &&
                    (!link.requiresPirate || gameState.pirateMode)
                );
                
                const linkEl = document.createElement('a');
                linkEl.href = '#';
                linkEl.className = 'link-item';
                if (!accessible) linkEl.className += ' locked';
                
                // Special handling for the essay
                if (link.name === 'Berggruen Essay') {
                    linkEl.innerHTML = accessible ? 
                        `→ ${link.name}` : 
                        `→ ${link.name} [CLASSIFIED]`;
                } else {
                    linkEl.innerHTML = accessible ? 
                        `→ ${link.name}` : 
                        `→ ${link.name} [INSUFFICIENT CLEARANCE]`;
                }
                
                linkEl.onclick = (e) => {
                    e.preventDefault();
                    if (accessible) {
                        if (link.name === 'Berggruen Essay' && gameState.pirateCertainty >= 90) {
                            triggerEndgame();
                        } else {
                            alert(`${link.name}: ${link.description}`);
                        }
                    }
                };
                
                container.appendChild(linkEl);
            });
        }

        // Trigger philosophical glitch
        function triggerPhilosophicalGlitch() {
            if (Math.random() > 0.7) {
                const message = philosophicalWarnings[Math.floor(Math.random() * philosophicalWarnings.length)];
                const glitchDiv = document.getElementById('glitchMessage');
                glitchDiv.textContent = message;
                glitchDiv.style.display = 'block';
                setTimeout(() => {
                    glitchDiv.style.display = 'none';
                }, 2500);
            }
        }

        // Update stats display
        function updateStats() {
            document.getElementById('candidatesReviewedCount').textContent = gameState.candidatesReviewed.length;
            document.getElementById('achievementCount').textContent = gameState.achievementsUnlocked.length;
            document.getElementById('mapCount').textContent = gameState.realityMapsCollected.length;
        }

        // Update candidate list
        function updateCandidateList() {
            const listContainer = document.getElementById('dynamicCandidateList');
            let accessible = getAccessibleSlots(gameState.certainty);
            
            // No emergency slot needed with new system
            
            listContainer.innerHTML = '';
            
            for (let i = 0; i < 8; i++) {
                const slot = document.createElement('div');
                slot.className = 'candidate-slot';
                
                const isReviewed = gameState.candidatesReviewed.includes(candidates[i].id);
                const isAccessible = accessible.includes(i);
                
                // In pirate mode, only Renderer is clickable for now
                const isPirateAccessible = gameState.pirateMode && i === 0;
                
                if (isAccessible && (!gameState.pirateMode || isPirateAccessible)) {
                    const candidate = candidates[i];
                    slot.className += ' accessible';
                    
                    if (isReviewed && !gameState.pirateMode) {
                        slot.innerHTML = `${i + 1}. ${candidate.name} - ${candidate.portfolio}<br>
                            <small style="opacity: 0.7">[REVIEWED ✓ - Try different answers?]</small>`;
                    } else if (gameState.pirateMode) {
                        slot.innerHTML = `${i + 1}. ${candidate.name} - Ready for interrogation`;
                    } else {
                        slot.innerHTML = `${i + 1}. ${candidate.name} - ${candidate.portfolio}<br>
                            <small style="opacity: 0.7">→ ${candidate.valveValue}</small>`;
                    }
                    
                    slot.onclick = () => gameState.pirateMode ? startInterrogation(candidate.id) : reviewCandidate(candidate.id);
                } else if (gameState.pirateMode && !isPirateAccessible) {
                    slot.className += ' locked';
                    slot.innerHTML = `${i + 1}. ${candidates[i].name} - [INTERROGATION SYSTEM LOADING...]`;
                } else {
                    slot.className += ' locked';
                    slot.innerHTML = `[SLOT ${i + 1}: LOCKED - INSUFFICIENT CLEARANCE]`;
                }
                
                listContainer.appendChild(slot);
            }
            
            if (gameState.certainty <= 4 && !gameState.pirateMode) {
                const voidMessage = document.createElement('div');
                voidMessage.style.marginTop = '40px';
                voidMessage.style.color = '#ff00ff';
                voidMessage.innerHTML = 'All doors are closing.<br>But something new appears...<br>Look to the corner → → →';
                listContainer.appendChild(voidMessage);
            }
            
            updateStats();
            updatePortfolioLinks();
        }

        // Screen navigation
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            // Hide reality status on intro screen
            const statusDiv = document.querySelector('.reality-status');
            if (screenId === 'intro') {
                statusDiv.style.display = 'none';
            } else {
                statusDiv.style.display = 'block';
            }
        }

        function goToProfile() {
            showScreen('profile');
            // Show reality status after intro
            document.querySelector('.reality-status').style.display = 'block';
        }

        function beginReview() {
            const name = document.getElementById('reviewerName').value || 'Anonymous';
            gameState.reviewerName = name;
            document.getElementById('reviewerDisplay').textContent = name;
            updateCandidateList();
            showScreen('candidateList');
            
            setInterval(() => {
                if (gameState.certainty < 50 && gameState.certainty > 0 && !gameState.pirateMode) {
                    triggerPhilosophicalGlitch();
                }
            }, 5000);
        }

        // Review candidate
        function reviewCandidate(candidateId) {
            const room = candidateRooms[candidateId];
            
            // Simple green text intro
            let introHTML = '';
            if (room.greeting) {
                introHTML += `<div class="greeting">${room.greeting}</div>`;
            }
            if (room.intro) {
                introHTML += `${room.intro}`;
            }
            
            document.getElementById('candidateIntro').innerHTML = introHTML;
            
            document.getElementById('candidateContent').innerHTML = `
                <div style="color: #00ff00; font-size: 18px; margin: 20px 0;">
                    I'll be happy to show you my portfolio and credentials...<br>
                    But first, can I ask YOU a question?
                </div>
            `;
            
            document.getElementById('candidateQuestion').innerHTML = '';
            document.getElementById('candidateOptions').innerHTML = `
                <button onclick="enterLabyrinth('${candidateId}')">Yes, ask your question</button>
                <button onclick="showPortfolio('${candidateId}')">No, I'm busy - just show the work</button>
            `;
            
            showScreen('candidateReview');
        }
        
        // Enter the philosophical labyrinth
        function enterLabyrinth(candidateId) {
            const room = candidateRooms[candidateId];
            
            // Clear the intro
            document.getElementById('candidateIntro').innerHTML = '';
            
            // For Juan/Renderer - just show the question
            if (candidateId === 'renderer') {
                document.getElementById('candidateContent').innerHTML = '';
            } else {
                // Other candidates keep simpler format for now
                let introHTML = '';
                if (room.portfolio) {
                    introHTML += `<div>${room.portfolio}</div>`;
                }
                if (room.value) {
                    introHTML += `<div style="margin-top: 10px;">${room.value}</div>`;
                }
                document.getElementById('candidateContent').innerHTML = introHTML;
            }
            
            // Use leadIn as the question
            document.getElementById('candidateQuestion').innerHTML = `<br>${room.leadIn || room.question}`;
            
            let optionsHTML = '<br>';
            room.options.forEach((opt, i) => {
                optionsHTML += `<button onclick="answerQuestion('${candidateId}', ${i})">${opt.text}</button>`;
            });
            document.getElementById('candidateOptions').innerHTML = optionsHTML;
        }
        
        // Show portfolio - THE TRAP!
        function showPortfolio(candidateId) {
            const room = candidateRooms[candidateId];
            const candidate = candidates.find(c => c.id === candidateId);
            
            document.getElementById('portfolioContent').innerHTML = `
                <div style="color: #00ff00;">
                    Thank you for your time!<br><br>
                    Juan Sebastian Niño says:<br>
                    <span style="color: #00ff00; font-style: italic;">
                        "Here is my reel and credentials.<br>
                        But remember, the application is part of the work.<br>
                        You are welcome to keep exploring."
                    </span>
                </div>
            `;
            
            showScreen('portfolioScreen');
        }
        
        // Exit review - CHECK FOR DEATH!
        function exitReview() {
            if (gameState.certainty === 100) {
                showScreen('deathScreen');
            } else {
                document.getElementById('portfolioContent').innerHTML = `
                    <div style="color: #00ff00; font-size: 24px;">
                        Review Complete<br><br>
                        Certainty Level: ${gameState.certainty}%<br>
                        Status: TRANSFORMED<br><br>
                        <span style="color: #00ffff;">
                            You've changed.<br>
                            The labyrinth has done its work.<br>
                            You may proceed.
                        </span>
                    </div>
                `;
                setTimeout(() => {
                    alert(`Achievement Unlocked: SURVIVED THE REVIEW at ${gameState.certainty}% certainty`);
                    location.reload();
                }, 3000);
            }
        }

        function answerQuestion(candidateId, optionIndex) {
            const room = candidateRooms[candidateId];
            const option = room.options[optionIndex];
            const effect = option.effect;
            
            // Check if this option triggers portfolio trap
            if (option.triggersPortfolio) {
                showPortfolio(candidateId);
                return;
            }
            
            gameState.certainty = Math.max(0, Math.min(100, gameState.certainty + effect));
            document.getElementById('certainty').textContent = gameState.certainty;
            
            updateRealityMode();
            
            const isFirstReview = !gameState.candidatesReviewed.includes(candidateId);
            
            if (isFirstReview) {
                gameState.candidatesReviewed.push(candidateId);
                gameState.trophiesUnlocked.push(room.trophy);
            }
            
            // Check if this unlocks the dreamer
            if (option.unlocksDreamer && candidateId === 'renderer') {
                // Force certainty to unlock dreamer if needed
                if (gameState.certainty > 89) {
                    gameState.certainty = 89;
                    document.getElementById('certainty').textContent = gameState.certainty;
                    updateRealityMode();
                }
            }
            
            // Check for achievements based on certainty
            if (gameState.certainty <= 75 && !gameState.achievementsUnlocked.includes('questioning')) {
                gameState.achievementsUnlocked.push('questioning');
            }
            if (gameState.certainty <= 50 && !gameState.achievementsUnlocked.includes('uncertain')) {
                gameState.achievementsUnlocked.push('uncertain');
            }
            if (gameState.certainty <= 25 && !gameState.achievementsUnlocked.includes('void')) {
                gameState.achievementsUnlocked.push('void');
            }
            if (gameState.certainty === 0 && !gameState.achievementsUnlocked.includes('zero')) {
                gameState.achievementsUnlocked.push('zero');
            }
            
            showTrophy(room.trophy, isFirstReview);
        }

        function showTrophy(trophyName, isFirstReview) {
            document.getElementById('trophyIcon').style.display = 'block';
            
            let message = '';
            if (isFirstReview) {
                message = `Achievement Unlocked!<br><br>
                    🏆 ${trophyName}<br><br>`;
            } else {
                message = `Re-reviewing: ${trophyName}<br><br>
                    Different answers lead to different certainties...<br>
                    Current Certainty: ${gameState.certainty}%<br><br>`;
            }
            
            message += `
                Trophies: ${gameState.trophiesUnlocked.length}/8<br>
                Certainty: ${gameState.certainty}%<br>
                Reality Mode: ${gameState.realityMode}
            `;
            
            // Check if dreamer is now accessible
            const accessible = getAccessibleSlots(gameState.certainty);
            if (accessible.includes(1) && !gameState.candidatesReviewed.includes('dreamer')) {
                message += `<br><br><span style="color: #ffff00">NEW CANDIDATE UNLOCKED: THE DREAMER</span>`;
            }
            
            if (gameState.certainty <= 75 && gameState.certainty > 50) {
                message += `<br><br><span style="color: #ffff00">Achievement: QUESTIONING REALITY</span>`;
            } else if (gameState.certainty <= 50 && gameState.certainty > 25) {
                message += `<br><br><span style="color: #ff00ff">Achievement: DEEP UNCERTAINTY</span>`;
            } else if (gameState.certainty <= 25 && gameState.certainty > 0) {
                message += `<br><br><span style="color: #00ffff">Achievement: APPROACHING THE VOID</span>`;
            } else if (gameState.certainty === 0) {
                message += `<br><br><span style="color: #ff00ff">Achievement: ZERO POINT - Look for {🌊:🌊∈🌊}</span>`;
            }
            
            if (gameState.candidatesReviewed.length === 8) {
                message += `<br><br>
                    <span style="color: #ff00ff">ALL CANDIDATES REVIEWED</span><br>
                    <span style="color: #ff00ff">But something feels incomplete...</span><br>
                    <span style="opacity: 0.5">Perhaps at zero certainty, new truths emerge?</span>
                `;
            }
            
            document.getElementById('trophyText').innerHTML = message;
            showScreen('trophyScreen');
        }

        function returnToList() {
            gameState.loopCount++;
            updateCandidateList();
            showScreen('candidateList');
        }

        // Pirate Mode
        function activatePirateMode() {
            gameState.pirateMode = true;
            showScreen('pirateMode');
        }
        
        function startPirateMode() {
            gameState.pirateMode = true;
            gameState.pirateCertainty = 0;
            document.body.className = 'pirate-mode';
            updateCandidateList();
            showScreen('candidateList');
        }

        function startInterrogation(candidateId) {
            if (candidateId !== 'renderer') {
                alert('Only The Renderer interrogation is implemented in this prototype!');
                return;
            }
            
            gameState.currentInterrogation = candidateId;
            
            const content = `
                <div class="captain-speech">
                    Captain SLOTH: "Ah, The Renderer! Also known as Juan Sebastian Niño! 
                    This one thinks everything is pixels and polish. 
                    Let's break that certainty and find the map he's hiding!"
                </div><br>
                
                Juan sits across from you, perfectly still, calculating.<br><br>
                
                Captain SLOTH whispers: "Choose your approach, mate!"
            `;
            
            document.getElementById('interrogationContent').innerHTML = content;
            document.getElementById('interrogationOptions').innerHTML = `
                <button class="interrogation-option" onclick="interrogate('good')">
                    Good Pirate: "Your precision is admirable..."
                </button>
                <button class="interrogation-option" onclick="interrogate('bad')">
                    Bad Pirate: "Your reality is a prison!"
                </button>
            `;
            
            showScreen('interrogation');
        }

        function interrogate(approach) {
            let response = '';
            
            if (approach === 'good') {
                response = `
                    <div style="color: #00ff00">
                        You: "Your precision is admirable. Help us understand your method."
                    </div><br>
                    
                    <div style="color: #888">
                        Juan: "I... appreciate the respect. My method is simple: measure twice, render once.
                        Everything has coordinates. Everything has rules."
                    </div><br>
                    
                    <div class="captain-speech">
                        Captain SLOTH: "Ha! See how they open up with kindness? Now ask about dreams! 
                        Ask what happens when they try to render something impossible!"
                    </div><br>
                    
                    <div style="color: #ffff00">
                        Juan begins to glitch slightly...<br>
                        "Dreams? I... I can't render dreams. They have no fixed coordinates. Unless..."<br>
                        "Unless the coordinates themselves are dreaming?"<br><br>
                        
                        *Juan reaches into his code and pulls out a shimmering map*<br><br>
                        
                        "⚙️ MECHANICAL UNIVERSE MAP EXTRACTED!"
                    </div>
                `;
                
                if (!gameState.realityMapsCollected.includes('⚙️ Mechanical Universe Map')) {
                    gameState.realityMapsCollected.push('⚙️ Mechanical Universe Map');
                }
                
                // Increase pirate certainty
                gameState.pirateCertainty += 15;
            } else {
                response = `
                    <div style="color: #ff0000">
                        You: "Your reality is a prison! Machines can't dream!"
                    </div><br>
                    
                    <div style="color: #888">
                        Juan: "Prison? No! It's... it's order! Without it, there's only chaos!
                        Every pixel has purpose! Every frame has meaning!"
                    </div><br>
                    
                    <div class="captain-speech">
                        Captain SLOTH: "Good! He's defensive! Now I'll be nice, confuse him!<br>
                        'But friend, who programmed the first pixel? Who rendered the renderer?'"
                    </div><br>
                    
                    <div style="color: #ffff00">
                        Juan freezes, processing...<br>
                        "Who... rendered... me? I render, therefore I... but who..?"<br>
                        "ERROR ERROR ERROR"<br><br>
                        
                        *In the confusion, a map falls from his portfolio*<br><br>
                        
                        "⚙️ MECHANICAL UNIVERSE MAP EXTRACTED!"
                    </div>
                `;
                
                if (!gameState.realityMapsCollected.includes('⚙️ Mechanical Universe Map')) {
                    gameState.realityMapsCollected.push('⚙️ Mechanical Universe Map');
                }
                
                // Increase pirate certainty
                gameState.pirateCertainty += 20;
            }
            
            document.getElementById('interrogationContent').innerHTML = response;
            document.getElementById('interrogationOptions').innerHTML = `
                <button onclick="returnToList()">Continue the Heist</button>
            `;
            
            document.getElementById('certainty').textContent = gameState.pirateCertainty;
            updateStats();
        }
        
        // Endgame trigger (for Berggruen essay)
        function triggerEndgame() {
            alert('ENDGAME: Captain SLOTH has a final question about consciousness... Coming soon!');
        }

        // Console Easter Egg
        console.log('%c⚠️ CURSED WATERS AHEAD ⚠️', 'color: red; font-size: 20px;');
        console.log('%cReading this before playing? The curse is yours now.', 'color: red;');
        console.log('%cThe missing 5 maps: Platonic, Hermetic, Islamic Mystical, Medicine Wheel, Vedic', 'color: cyan;');
        console.log('%cBut are they really missing, or just hidden in plain sight?', 'color: magenta;');
    </script>
</body>
</html>
